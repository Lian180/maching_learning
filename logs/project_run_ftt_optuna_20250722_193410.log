2025-07-22 19:34:10,195 - INFO - --- 机器学习房屋价格预测项目 (深度学习版) - 集成FT-Transformer和Optuna启动 ---
2025-07-22 19:34:10,198 - INFO - 已设置随机种子为: 42
2025-07-22 19:34:10,198 - INFO - 
--- Phase 1: Data Acquisition, Exploration, and Preprocessing ---
2025-07-22 19:34:10,220 - INFO - 数据从 './data/california_housing.csv' 加载成功！
2025-07-22 19:34:10,222 - INFO - 
--- 数据概览 ---
2025-07-22 19:34:10,222 - INFO - 数据前5行:
2025-07-22 19:34:10,222 - INFO -    MedInc  HouseAge  AveRooms  AveBedrms  Population  AveOccup  Latitude  Longitude  MedHouseVal  target
0  8.3252      41.0  6.984127   1.023810       322.0  2.555556     37.88    -122.23        4.526   4.526
1  8.3014      21.0  6.238137   0.971880      2401.0  2.109842     37.86    -122.22        3.585   3.585
2  7.2574      52.0  8.288136   1.073446       496.0  2.802260     37.85    -122.24        3.521   3.521
3  5.6431      52.0  5.817352   1.073059       558.0  2.547945     37.85    -122.25        3.413   3.413
4  3.8462      52.0  6.281853   1.081081       565.0  2.181467     37.85    -122.25        3.422   3.422
2025-07-22 19:34:10,243 - INFO - 
数据基本信息:
2025-07-22 19:34:10,251 - INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 10 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   MedInc       20640 non-null  float64
 1   HouseAge     20640 non-null  float64
 2   AveRooms     20640 non-null  float64
 3   AveBedrms    20640 non-null  float64
 4   Population   20640 non-null  float64
 5   AveOccup     20640 non-null  float64
 6   Latitude     20640 non-null  float64
 7   Longitude    20640 non-null  float64
 8   MedHouseVal  20640 non-null  float64
 9   target       20640 non-null  float64
dtypes: float64(10)
memory usage: 1.6 MB

2025-07-22 19:34:10,251 - INFO - 
描述性统计:
2025-07-22 19:34:10,266 - INFO -              MedInc      HouseAge      AveRooms     AveBedrms    Population      AveOccup      Latitude     Longitude   MedHouseVal        target
count  20640.000000  20640.000000  20640.000000  20640.000000  20640.000000  20640.000000  20640.000000  20640.000000  20640.000000  20640.000000
mean       3.870671     28.639486      5.429000      1.096675   1425.476744      3.070655     35.631861   -119.569704      2.068558      2.068558
std        1.899822     12.585558      2.474173      0.473911   1132.462122     10.386050      2.135952      2.003532      1.153956      1.153956
min        0.499900      1.000000      0.846154      0.333333      3.000000      0.692308     32.540000   -124.350000      0.149990      0.149990
25%        2.563400     18.000000      4.440716      1.006079    787.000000      2.429741     33.930000   -121.800000      1.196000      1.196000
50%        3.534800     29.000000      5.229129      1.048780   1166.000000      2.818116     34.260000   -118.490000      1.797000      1.797000
75%        4.743250     37.000000      6.052381      1.099526   1725.000000      3.282261     37.710000   -118.010000      2.647250      2.647250
max       15.000100     52.000000    141.909091     34.066667  35682.000000   1243.333333     41.950000   -114.310000      5.000010      5.000010
2025-07-22 19:34:10,284 - INFO - 
缺失值检查:
2025-07-22 19:34:10,286 - INFO - MedInc         0
HouseAge       0
AveRooms       0
AveBedrms      0
Population     0
AveOccup       0
Latitude       0
Longitude      0
MedHouseVal    0
target         0
dtype: int64
2025-07-22 19:34:10,286 - INFO - 
数据初步探索完成。
2025-07-22 19:34:10,287 - INFO - 
--- 数据初步可视化 ---
2025-07-22 19:34:10,677 - INFO - 图表已保存到: logs\房屋价格分布.png
2025-07-22 19:34:13,303 - INFO - 图表已保存到: logs\特征与房价散点图.png
2025-07-22 19:34:16,168 - INFO - 
数据初步可视化完成。
2025-07-22 19:34:16,168 - INFO - 
--- 缺失值处理 ---
2025-07-22 19:34:16,169 - INFO - 数据集中没有发现缺失值。
2025-07-22 19:34:16,169 - INFO - 
--- 异常值处理 ---
2025-07-22 19:34:16,189 - INFO - 已使用 IQR 方法处理 5594 个异常值 (替换为边界值)。
2025-07-22 19:34:16,189 - INFO - 
--- 特征工程 ---
2025-07-22 19:34:16,193 - INFO - 已创建新特征 'Bedrms_Per_Room'。
2025-07-22 19:34:16,193 - INFO - 已创建新特征 'Population_Density'。
2025-07-22 19:34:16,193 - INFO - 已创建新特征 'Lat_x_Lon'。
2025-07-22 19:34:16,193 - INFO - 特征工程完成。
2025-07-22 19:34:16,193 - INFO - 
--- 数据划分与特征缩放 ---
2025-07-22 19:34:16,200 - INFO - 选择 StandardScaler 进行特征缩放。
2025-07-22 19:34:16,209 - INFO - 训练集特征形状: (16512, 12)
2025-07-22 19:34:16,209 - INFO - 测试集特征形状: (4128, 12)
2025-07-22 19:34:16,210 - INFO - 训练集目标形状: (16512,)
2025-07-22 19:34:16,210 - INFO - 测试集目标形状: (4128,)
2025-07-22 19:34:16,210 - INFO - 数据划分与特征缩放完成。
2025-07-22 19:34:16,211 - INFO - 
--- 数据划分与特征缩放 ---
2025-07-22 19:34:16,216 - INFO - 不进行特征缩放。
2025-07-22 19:34:16,216 - INFO - 训练集特征形状: (12384, 12)
2025-07-22 19:34:16,216 - INFO - 测试集特征形状: (4128, 12)
2025-07-22 19:34:16,216 - INFO - 训练集目标形状: (12384,)
2025-07-22 19:34:16,216 - INFO - 测试集目标形状: (4128,)
2025-07-22 19:34:16,216 - INFO - 数据划分与特征缩放完成。
2025-07-22 19:34:16,219 - INFO - Scaler saved to: ./models/scaler_ftt_optuna.pkl
2025-07-22 19:34:16,221 - INFO - 
Training set features shape (Tensor): torch.Size([12384, 12])
2025-07-22 19:34:16,221 - INFO - Validation set features shape (Tensor): torch.Size([4128, 12])
2025-07-22 19:34:16,221 - INFO - Test set features shape (Tensor): torch.Size([4128, 12])
2025-07-22 19:34:16,221 - INFO - Training set target shape (Tensor): torch.Size([12384, 1])
2025-07-22 19:34:16,221 - INFO - Validation set target shape (Tensor): torch.Size([4128, 1])
2025-07-22 19:34:16,221 - INFO - Test set target shape (Tensor): torch.Size([4128, 1])
2025-07-22 19:34:16,221 - INFO - Training data loader contains 194 batches.
2025-07-22 19:34:16,221 - INFO - Validation data loader contains 65 batches.
2025-07-22 19:34:16,221 - INFO - Test data loader contains 65 batches.
2025-07-22 19:34:16,221 - INFO - 
--- Phase 2: Hyperparameter Optimization (Optuna) ---
2025-07-22 19:34:16,221 - INFO - 
--- 开始 Optuna 超参数优化 (共 10 次试验) ---
2025-07-22 19:34:18,825 - INFO - Trial 0: 选择了 MLP 模型
2025-07-22 19:34:20,753 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:34:23,484 - INFO - Epoch [1/100], 训练损失: 62.0775, 验证损失: 0.3882, 验证 R2: 0.7173
2025-07-22 19:34:25,120 - INFO - Epoch [2/100], 训练损失: 0.2161, 验证损失: 0.0665, 验证 R2: 0.9516
2025-07-22 19:34:26,753 - INFO - Epoch [3/100], 训练损失: 0.0489, 验证损失: 0.1376, 验证 R2: 0.8998
2025-07-22 19:34:28,426 - INFO - Epoch [4/100], 训练损失: 0.0646, 验证损失: 0.0701, 验证 R2: 0.9489
2025-07-22 19:34:30,088 - INFO - Epoch [5/100], 训练损失: 0.2261, 验证损失: 0.0148, 验证 R2: 0.9892
2025-07-22 19:34:31,851 - INFO - Epoch [6/100], 训练损失: 0.0548, 验证损失: 0.0313, 验证 R2: 0.9772
2025-07-22 19:34:33,576 - INFO - Epoch [7/100], 训练损失: 0.0534, 验证损失: 0.0100, 验证 R2: 0.9927
2025-07-22 19:34:34,977 - INFO - Epoch [8/100], 训练损失: 0.0404, 验证损失: 0.0033, 验证 R2: 0.9976
2025-07-22 19:34:36,389 - INFO - Epoch [9/100], 训练损失: 0.0329, 验证损失: 0.0810, 验证 R2: 0.9410
2025-07-22 19:34:37,837 - INFO - Epoch [10/100], 训练损失: 0.0475, 验证损失: 0.0058, 验证 R2: 0.9958
2025-07-22 19:34:39,248 - INFO - Epoch [11/100], 训练损失: 0.0166, 验证损失: 0.0071, 验证 R2: 0.9948
2025-07-22 19:34:40,617 - INFO - Epoch [12/100], 训练损失: 0.0196, 验证损失: 0.0186, 验证 R2: 0.9865
2025-07-22 19:34:42,036 - INFO - Epoch [13/100], 训练损失: 0.0149, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 19:34:43,478 - INFO - Epoch [14/100], 训练损失: 0.0130, 验证损失: 0.0082, 验证 R2: 0.9940
2025-07-22 19:34:45,000 - INFO - Epoch [15/100], 训练损失: 0.0121, 验证损失: 0.0099, 验证 R2: 0.9928
2025-07-22 19:34:46,555 - INFO - Epoch [16/100], 训练损失: 0.0093, 验证损失: 0.0110, 验证 R2: 0.9920
2025-07-22 19:34:47,998 - INFO - Epoch [17/100], 训练损失: 0.0093, 验证损失: 0.0015, 验证 R2: 0.9989
2025-07-22 19:34:49,369 - INFO - Epoch [18/100], 训练损失: 0.0104, 验证损失: 0.0039, 验证 R2: 0.9972
2025-07-22 19:34:50,734 - INFO - Epoch [19/100], 训练损失: 0.0060, 验证损失: 0.0062, 验证 R2: 0.9955
2025-07-22 19:34:52,098 - INFO - Epoch [20/100], 训练损失: 0.0010, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 19:34:53,467 - INFO - Epoch [21/100], 训练损失: 0.0023, 验证损失: 0.0014, 验证 R2: 0.9989
2025-07-22 19:34:54,889 - INFO - Epoch [22/100], 训练损失: 0.0024, 验证损失: 0.0059, 验证 R2: 0.9957
2025-07-22 19:34:56,332 - INFO - Epoch [23/100], 训练损失: 0.0021, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:34:57,694 - INFO - Epoch [24/100], 训练损失: 0.0017, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 19:34:59,103 - INFO - Epoch [25/100], 训练损失: 0.0020, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:35:00,518 - INFO - Epoch [26/100], 训练损失: 0.0018, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 19:35:01,944 - INFO - Epoch [27/100], 训练损失: 0.0020, 验证损失: 0.0070, 验证 R2: 0.9949
2025-07-22 19:35:03,326 - INFO - Epoch [28/100], 训练损失: 0.0020, 验证损失: 0.0015, 验证 R2: 0.9989
2025-07-22 19:35:04,737 - INFO - Epoch [29/100], 训练损失: 0.0018, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:35:06,119 - INFO - Epoch [30/100], 训练损失: 0.0017, 验证损失: 0.0080, 验证 R2: 0.9942
2025-07-22 19:35:07,471 - INFO - Epoch [31/100], 训练损失: 0.0018, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:35:08,861 - INFO - Epoch [32/100], 训练损失: 0.0019, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:35:10,222 - INFO - Epoch [33/100], 训练损失: 0.0018, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:35:11,604 - INFO - Epoch [34/100], 训练损失: 0.0015, 验证损失: 0.0013, 验证 R2: 0.9991
2025-07-22 19:35:13,038 - INFO - Epoch [35/100], 训练损失: 0.0017, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:35:14,422 - INFO - Epoch [36/100], 训练损失: 0.0018, 验证损失: 0.0013, 验证 R2: 0.9991
2025-07-22 19:35:15,820 - INFO - Epoch [37/100], 训练损失: 0.0018, 验证损失: 0.0018, 验证 R2: 0.9987
2025-07-22 19:35:17,272 - INFO - Epoch [38/100], 训练损失: 0.0003, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:35:18,837 - INFO - Epoch [39/100], 训练损失: 0.0005, 验证损失: 0.0010, 验证 R2: 0.9993
2025-07-22 19:35:20,413 - INFO - Epoch [40/100], 训练损失: 0.0005, 验证损失: 0.0010, 验证 R2: 0.9993
2025-07-22 19:35:21,914 - INFO - Epoch [41/100], 训练损失: 0.0005, 验证损失: 0.0014, 验证 R2: 0.9989
2025-07-22 19:35:21,914 - INFO - 早停！验证损失在 10 个epoch内没有显著改善。
2025-07-22 19:35:21,919 - INFO - --- 模型训练完成 ---
2025-07-22 19:35:22,072 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 19:35:23,740 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 19:35:25,013 - INFO - Trial 1: 选择了 FT-Transformer 模型
2025-07-22 19:35:25,014 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:35:31,232 - INFO - Epoch [1/100], 训练损失: 6996.9633, 验证损失: 1.4545, 验证 R2: -0.0593
2025-07-22 19:35:36,874 - INFO - Epoch [2/100], 训练损失: 1.3526, 验证损失: 1.4187, 验证 R2: -0.0332
2025-07-22 19:35:42,483 - INFO - Epoch [3/100], 训练损失: 1.3513, 验证损失: 1.4063, 验证 R2: -0.0242
2025-07-22 19:35:48,099 - INFO - Epoch [4/100], 训练损失: 1.3602, 验证损失: 1.4247, 验证 R2: -0.0376
2025-07-22 19:35:53,739 - INFO - Epoch [5/100], 训练损失: 1.3735, 验证损失: 1.3853, 验证 R2: -0.0089
2025-07-22 19:35:59,782 - INFO - Epoch [6/100], 训练损失: 1.3554, 验证损失: 1.3739, 验证 R2: -0.0006
2025-07-22 19:36:05,509 - INFO - Epoch [7/100], 训练损失: 1.3547, 验证损失: 1.3747, 验证 R2: -0.0012
2025-07-22 19:36:11,307 - INFO - Epoch [8/100], 训练损失: 1.3611, 验证损失: 1.3746, 验证 R2: -0.0011
2025-07-22 19:36:17,147 - INFO - Epoch [9/100], 训练损失: 1.4094, 验证损失: 1.3921, 验证 R2: -0.0138
2025-07-22 19:36:23,070 - INFO - Epoch [10/100], 训练损失: 1.3503, 验证损失: 1.3755, 验证 R2: -0.0017
2025-07-22 19:36:28,881 - INFO - Epoch [11/100], 训练损失: 1.3544, 验证损失: 1.3740, 验证 R2: -0.0006
2025-07-22 19:36:34,654 - INFO - Epoch [12/100], 训练损失: 2.2082, 验证损失: 1.3760, 验证 R2: -0.0021
2025-07-22 19:36:40,417 - INFO - Epoch [13/100], 训练损失: 1.3313, 验证损失: 1.4080, 验证 R2: -0.0254
2025-07-22 19:36:46,189 - INFO - Epoch [14/100], 训练损失: 1.3328, 验证损失: 1.4800, 验证 R2: -0.0779
2025-07-22 19:36:52,008 - INFO - Epoch [15/100], 训练损失: 1.3371, 验证损失: 1.3815, 验证 R2: -0.0061
2025-07-22 19:36:58,072 - INFO - Epoch [16/100], 训练损失: 1.3416, 验证损失: 1.3731, 验证 R2: -0.0000
2025-07-22 19:37:04,006 - INFO - Epoch [17/100], 训练损失: 1.3404, 验证损失: 1.3889, 验证 R2: -0.0115
2025-07-22 19:37:09,948 - INFO - Epoch [18/100], 训练损失: 1.3357, 验证损失: 1.4024, 验证 R2: -0.0213
2025-07-22 19:37:15,922 - INFO - Epoch [19/100], 训练损失: 1.3403, 验证损失: 1.3732, 验证 R2: -0.0001
2025-07-22 19:37:21,873 - INFO - Epoch [20/100], 训练损失: 1.3368, 验证损失: 1.3793, 验证 R2: -0.0045
2025-07-22 19:37:27,754 - INFO - Epoch [21/100], 训练损失: 1.3359, 验证损失: 1.3737, 验证 R2: -0.0005
2025-07-22 19:37:33,609 - INFO - Epoch [22/100], 训练损失: 1.3322, 验证损失: 1.4931, 验证 R2: -0.0874
2025-07-22 19:37:39,415 - INFO - Epoch [23/100], 训练损失: 1.3331, 验证损失: 1.3742, 验证 R2: -0.0008
2025-07-22 19:37:45,208 - INFO - Epoch [24/100], 训练损失: 1.3293, 验证损失: 1.3732, 验证 R2: -0.0000
2025-07-22 19:37:50,997 - INFO - Epoch [25/100], 训练损失: 1.3284, 验证损失: 1.4293, 验证 R2: -0.0409
2025-07-22 19:37:56,766 - INFO - Epoch [26/100], 训练损失: 1.3536, 验证损失: 1.3742, 验证 R2: -0.0008
2025-07-22 19:37:56,766 - INFO - 早停！验证损失在 10 个epoch内没有显著改善。
2025-07-22 19:37:56,770 - INFO - --- 模型训练完成 ---
2025-07-22 19:37:56,931 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 19:37:58,936 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 19:38:00,794 - INFO - Trial 2: 选择了 MLP 模型
2025-07-22 19:38:00,795 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:38:02,104 - INFO - Epoch [1/100], 训练损失: 1.0185, 验证损失: 0.0888, 验证 R2: 0.9353
2025-07-22 19:38:03,410 - INFO - Epoch [2/100], 训练损失: 0.0296, 验证损失: 0.0160, 验证 R2: 0.9884
2025-07-22 19:38:04,723 - INFO - Epoch [3/100], 训练损失: 0.0117, 验证损失: 0.0110, 验证 R2: 0.9920
2025-07-22 19:38:06,008 - INFO - Epoch [4/100], 训练损失: 0.0081, 验证损失: 0.0091, 验证 R2: 0.9934
2025-07-22 19:38:07,352 - INFO - Epoch [5/100], 训练损失: 0.0062, 验证损失: 0.0078, 验证 R2: 0.9943
2025-07-22 19:38:08,591 - INFO - Epoch [6/100], 训练损失: 0.0051, 验证损失: 0.0071, 验证 R2: 0.9948
2025-07-22 19:38:09,952 - INFO - Epoch [7/100], 训练损失: 0.0043, 验证损失: 0.0066, 验证 R2: 0.9952
2025-07-22 19:38:11,281 - INFO - Epoch [8/100], 训练损失: 0.0038, 验证损失: 0.0060, 验证 R2: 0.9956
2025-07-22 19:38:12,622 - INFO - Epoch [9/100], 训练损失: 0.0032, 验证损失: 0.0059, 验证 R2: 0.9957
2025-07-22 19:38:13,943 - INFO - Epoch [10/100], 训练损失: 0.0028, 验证损失: 0.0057, 验证 R2: 0.9959
2025-07-22 19:38:15,257 - INFO - Epoch [11/100], 训练损失: 0.0025, 验证损失: 0.0051, 验证 R2: 0.9963
2025-07-22 19:38:16,523 - INFO - Epoch [12/100], 训练损失: 0.0022, 验证损失: 0.0050, 验证 R2: 0.9964
2025-07-22 19:38:17,722 - INFO - Epoch [13/100], 训练损失: 0.0020, 验证损失: 0.0050, 验证 R2: 0.9964
2025-07-22 19:38:18,972 - INFO - Epoch [14/100], 训练损失: 0.0018, 验证损失: 0.0047, 验证 R2: 0.9965
2025-07-22 19:38:20,173 - INFO - Epoch [15/100], 训练损失: 0.0016, 验证损失: 0.0046, 验证 R2: 0.9967
2025-07-22 19:38:21,372 - INFO - Epoch [16/100], 训练损失: 0.0015, 验证损失: 0.0047, 验证 R2: 0.9966
2025-07-22 19:38:22,552 - INFO - Epoch [17/100], 训练损失: 0.0014, 验证损失: 0.0043, 验证 R2: 0.9969
2025-07-22 19:38:23,772 - INFO - Epoch [18/100], 训练损失: 0.0013, 验证损失: 0.0042, 验证 R2: 0.9969
2025-07-22 19:38:24,986 - INFO - Epoch [19/100], 训练损失: 0.0012, 验证损失: 0.0040, 验证 R2: 0.9971
2025-07-22 19:38:26,224 - INFO - Epoch [20/100], 训练损失: 0.0010, 验证损失: 0.0040, 验证 R2: 0.9971
2025-07-22 19:38:27,397 - INFO - Epoch [21/100], 训练损失: 0.0010, 验证损失: 0.0043, 验证 R2: 0.9969
2025-07-22 19:38:28,639 - INFO - Epoch [22/100], 训练损失: 0.0010, 验证损失: 0.0040, 验证 R2: 0.9971
2025-07-22 19:38:29,684 - INFO - Epoch [23/100], 训练损失: 0.0009, 验证损失: 0.0038, 验证 R2: 0.9972
2025-07-22 19:38:30,704 - INFO - Epoch [24/100], 训练损失: 0.0010, 验证损失: 0.0038, 验证 R2: 0.9973
2025-07-22 19:38:31,755 - INFO - Epoch [25/100], 训练损失: 0.0011, 验证损失: 0.0039, 验证 R2: 0.9971
2025-07-22 19:38:32,804 - INFO - Epoch [26/100], 训练损失: 0.0010, 验证损失: 0.0038, 验证 R2: 0.9973
2025-07-22 19:38:33,819 - INFO - Epoch [27/100], 训练损失: 0.0009, 验证损失: 0.0041, 验证 R2: 0.9970
2025-07-22 19:38:34,848 - INFO - Epoch [28/100], 训练损失: 0.0011, 验证损失: 0.0037, 验证 R2: 0.9973
2025-07-22 19:38:36,023 - INFO - Epoch [29/100], 训练损失: 0.0012, 验证损失: 0.0037, 验证 R2: 0.9973
2025-07-22 19:38:37,138 - INFO - Epoch [30/100], 训练损失: 0.0012, 验证损失: 0.0037, 验证 R2: 0.9973
2025-07-22 19:38:38,201 - INFO - Epoch [31/100], 训练损失: 0.0010, 验证损失: 0.0039, 验证 R2: 0.9971
2025-07-22 19:38:39,283 - INFO - Epoch [32/100], 训练损失: 0.0011, 验证损失: 0.0041, 验证 R2: 0.9970
2025-07-22 19:38:40,364 - INFO - Epoch [33/100], 训练损失: 0.0011, 验证损失: 0.0034, 验证 R2: 0.9975
2025-07-22 19:38:41,555 - INFO - Epoch [34/100], 训练损失: 0.0009, 验证损失: 0.0034, 验证 R2: 0.9975
2025-07-22 19:38:42,820 - INFO - Epoch [35/100], 训练损失: 0.0010, 验证损失: 0.0036, 验证 R2: 0.9974
2025-07-22 19:38:44,096 - INFO - Epoch [36/100], 训练损失: 0.0012, 验证损失: 0.0034, 验证 R2: 0.9975
2025-07-22 19:38:45,405 - INFO - Epoch [37/100], 训练损失: 0.0014, 验证损失: 0.0036, 验证 R2: 0.9974
2025-07-22 19:38:46,772 - INFO - Epoch [38/100], 训练损失: 0.0015, 验证损失: 0.0040, 验证 R2: 0.9971
2025-07-22 19:38:48,157 - INFO - Epoch [39/100], 训练损失: 0.0012, 验证损失: 0.0035, 验证 R2: 0.9975
2025-07-22 19:38:49,505 - INFO - Epoch [40/100], 训练损失: 0.0005, 验证损失: 0.0028, 验证 R2: 0.9980
2025-07-22 19:38:50,741 - INFO - Epoch [41/100], 训练损失: 0.0003, 验证损失: 0.0028, 验证 R2: 0.9980
2025-07-22 19:38:51,929 - INFO - Epoch [42/100], 训练损失: 0.0002, 验证损失: 0.0027, 验证 R2: 0.9980
2025-07-22 19:38:53,156 - INFO - Epoch [43/100], 训练损失: 0.0002, 验证损失: 0.0027, 验证 R2: 0.9980
2025-07-22 19:38:54,372 - INFO - Epoch [44/100], 训练损失: 0.0002, 验证损失: 0.0027, 验证 R2: 0.9981
2025-07-22 19:38:55,526 - INFO - Epoch [45/100], 训练损失: 0.0002, 验证损失: 0.0028, 验证 R2: 0.9980
2025-07-22 19:38:56,704 - INFO - Epoch [46/100], 训练损失: 0.0002, 验证损失: 0.0028, 验证 R2: 0.9980
2025-07-22 19:38:57,837 - INFO - Epoch [47/100], 训练损失: 0.0002, 验证损失: 0.0027, 验证 R2: 0.9980
2025-07-22 19:38:58,914 - INFO - Epoch [48/100], 训练损失: 0.0002, 验证损失: 0.0027, 验证 R2: 0.9980
2025-07-22 19:38:59,948 - INFO - Epoch [49/100], 训练损失: 0.0003, 验证损失: 0.0027, 验证 R2: 0.9980
2025-07-22 19:39:00,960 - INFO - Epoch [50/100], 训练损失: 0.0002, 验证损失: 0.0030, 验证 R2: 0.9978
2025-07-22 19:39:01,976 - INFO - Epoch [51/100], 训练损失: 0.0002, 验证损失: 0.0027, 验证 R2: 0.9980
2025-07-22 19:39:03,004 - INFO - Epoch [52/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:04,029 - INFO - Epoch [53/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:05,084 - INFO - Epoch [54/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:06,141 - INFO - Epoch [55/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:07,378 - INFO - Epoch [56/100], 训练损失: 0.0001, 验证损失: 0.0027, 验证 R2: 0.9981
2025-07-22 19:39:08,921 - INFO - Epoch [57/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:10,088 - INFO - Epoch [58/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:11,335 - INFO - Epoch [59/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:12,533 - INFO - Epoch [60/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:13,754 - INFO - Epoch [61/100], 训练损失: 0.0001, 验证损失: 0.0027, 验证 R2: 0.9980
2025-07-22 19:39:14,947 - INFO - Epoch [62/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:16,205 - INFO - Epoch [63/100], 训练损失: 0.0001, 验证损失: 0.0027, 验证 R2: 0.9981
2025-07-22 19:39:17,435 - INFO - Epoch [64/100], 训练损失: 0.0002, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:18,620 - INFO - Epoch [65/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:19,843 - INFO - Epoch [66/100], 训练损失: 0.0001, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:21,588 - INFO - Epoch [67/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:22,821 - INFO - Epoch [68/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:24,058 - INFO - Epoch [69/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:25,513 - INFO - Epoch [70/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:26,823 - INFO - Epoch [71/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:28,124 - INFO - Epoch [72/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:29,306 - INFO - Epoch [73/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:30,480 - INFO - Epoch [74/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:31,639 - INFO - Epoch [75/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:32,793 - INFO - Epoch [76/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:33,971 - INFO - Epoch [77/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:35,176 - INFO - Epoch [78/100], 训练损失: 0.0000, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:39:35,176 - INFO - 早停！验证损失在 10 个epoch内没有显著改善。
2025-07-22 19:39:35,179 - INFO - --- 模型训练完成 ---
2025-07-22 19:39:35,329 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 19:39:37,289 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 19:39:38,493 - INFO - Trial 3: 选择了 MLP 模型
2025-07-22 19:39:38,493 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:39:39,809 - INFO - Epoch [1/100], 训练损失: 0.3446, 验证损失: 0.0272, 验证 R2: 0.9802
2025-07-22 19:39:40,859 - INFO - Epoch [2/100], 训练损失: 0.0474, 验证损失: 0.0046, 验证 R2: 0.9967
2025-07-22 19:39:41,965 - INFO - Epoch [3/100], 训练损失: 0.0235, 验证损失: 0.0057, 验证 R2: 0.9958
2025-07-22 19:39:43,153 - INFO - Epoch [4/100], 训练损失: 0.0173, 验证损失: 0.0022, 验证 R2: 0.9984
2025-07-22 19:39:44,263 - INFO - Epoch [5/100], 训练损失: 0.0133, 验证损失: 0.0142, 验证 R2: 0.9896
2025-07-22 19:39:45,388 - INFO - Epoch [6/100], 训练损失: 0.0101, 验证损失: 0.0023, 验证 R2: 0.9984
2025-07-22 19:39:46,457 - INFO - Epoch [7/100], 训练损失: 0.0088, 验证损失: 0.0040, 验证 R2: 0.9971
2025-07-22 19:39:47,578 - INFO - Epoch [8/100], 训练损失: 0.0076, 验证损失: 0.0020, 验证 R2: 0.9986
2025-07-22 19:39:48,764 - INFO - Epoch [9/100], 训练损失: 0.0068, 验证损失: 0.0064, 验证 R2: 0.9953
2025-07-22 19:39:49,863 - INFO - Epoch [10/100], 训练损失: 0.0053, 验证损失: 0.0016, 验证 R2: 0.9988
2025-07-22 19:39:51,007 - INFO - Epoch [11/100], 训练损失: 0.0057, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 19:39:52,097 - INFO - Epoch [12/100], 训练损失: 0.0051, 验证损失: 0.0024, 验证 R2: 0.9983
2025-07-22 19:39:53,260 - INFO - Epoch [13/100], 训练损失: 0.0046, 验证损失: 0.0137, 验证 R2: 0.9900
2025-07-22 19:39:54,430 - INFO - Epoch [14/100], 训练损失: 0.0044, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:39:55,550 - INFO - Epoch [15/100], 训练损失: 0.0042, 验证损失: 0.0009, 验证 R2: 0.9994
2025-07-22 19:39:56,665 - INFO - Epoch [16/100], 训练损失: 0.0042, 验证损失: 0.0010, 验证 R2: 0.9993
2025-07-22 19:39:57,801 - INFO - Epoch [17/100], 训练损失: 0.0034, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:39:59,207 - INFO - Epoch [18/100], 训练损失: 0.0036, 验证损失: 0.0196, 验证 R2: 0.9857
2025-07-22 19:40:00,323 - INFO - Epoch [19/100], 训练损失: 0.0038, 验证损失: 0.0054, 验证 R2: 0.9961
2025-07-22 19:40:01,440 - INFO - Epoch [20/100], 训练损失: 0.0032, 验证损失: 0.0018, 验证 R2: 0.9987
2025-07-22 19:40:02,505 - INFO - Epoch [21/100], 训练损失: 0.0039, 验证损失: 0.0113, 验证 R2: 0.9918
2025-07-22 19:40:03,606 - INFO - Epoch [22/100], 训练损失: 0.0028, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:40:04,744 - INFO - Epoch [23/100], 训练损失: 0.0030, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 19:40:05,873 - INFO - Epoch [24/100], 训练损失: 0.0005, 验证损失: 0.0009, 验证 R2: 0.9993
2025-07-22 19:40:07,006 - INFO - Epoch [25/100], 训练损失: 0.0012, 验证损失: 0.0020, 验证 R2: 0.9985
2025-07-22 19:40:08,075 - INFO - Epoch [26/100], 训练损失: 0.0009, 验证损失: 0.0025, 验证 R2: 0.9982
2025-07-22 19:40:09,175 - INFO - Epoch [27/100], 训练损失: 0.0010, 验证损失: 0.0031, 验证 R2: 0.9977
2025-07-22 19:40:09,175 - INFO - 早停！验证损失在 10 个epoch内没有显著改善。
2025-07-22 19:40:09,178 - INFO - --- 模型训练完成 ---
2025-07-22 19:40:09,329 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 19:40:11,028 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 19:40:12,488 - INFO - Trial 4: 选择了 FT-Transformer 模型
2025-07-22 19:40:12,489 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:40:16,319 - INFO - Epoch [1/100], 训练损失: 7.7551, 验证损失: 1.4107, 验证 R2: -0.0274
2025-07-22 19:40:19,902 - INFO - Epoch [2/100], 训练损失: 1.4218, 验证损失: 1.7598, 验证 R2: -0.2816
2025-07-22 19:40:23,393 - INFO - Epoch [3/100], 训练损失: 1.4088, 验证损失: 1.4512, 验证 R2: -0.0568
2025-07-22 19:40:27,104 - INFO - Epoch [4/100], 训练损失: 1.3831, 验证损失: 1.7709, 验证 R2: -0.2897
2025-07-22 19:40:30,654 - INFO - Epoch [5/100], 训练损失: 1.3627, 验证损失: 1.3796, 验证 R2: -0.0047
2025-07-22 19:40:34,358 - INFO - Epoch [6/100], 训练损失: 1.3511, 验证损失: 1.3751, 验证 R2: -0.0015
2025-07-22 19:40:38,059 - INFO - Epoch [7/100], 训练损失: 1.4040, 验证损失: 1.4799, 验证 R2: -0.0778
2025-07-22 19:40:41,656 - INFO - Epoch [8/100], 训练损失: 1.3728, 验证损失: 1.4117, 验证 R2: -0.0281
2025-07-22 19:40:45,349 - INFO - Epoch [9/100], 训练损失: 1.3428, 验证损失: 1.3840, 验证 R2: -0.0080
2025-07-22 19:40:48,644 - INFO - Epoch [10/100], 训练损失: 1.3470, 验证损失: 1.3744, 验证 R2: -0.0010
2025-07-22 19:40:51,970 - INFO - Epoch [11/100], 训练损失: 1.3428, 验证损失: 1.3851, 验证 R2: -0.0087
2025-07-22 19:40:55,267 - INFO - Epoch [12/100], 训练损失: 1.3420, 验证损失: 1.3734, 验证 R2: -0.0002
2025-07-22 19:40:58,539 - INFO - Epoch [13/100], 训练损失: 1.3360, 验证损失: 1.4141, 验证 R2: -0.0298
2025-07-22 19:41:01,887 - INFO - Epoch [14/100], 训练损失: 1.3413, 验证损失: 1.3778, 验证 R2: -0.0034
2025-07-22 19:41:05,417 - INFO - Epoch [15/100], 训练损失: 1.3365, 验证损失: 1.3849, 验证 R2: -0.0086
2025-07-22 19:41:08,839 - INFO - Epoch [16/100], 训练损失: 1.3396, 验证损失: 1.3731, 验证 R2: -0.0000
2025-07-22 19:41:12,439 - INFO - Epoch [17/100], 训练损失: 1.3354, 验证损失: 1.3941, 验证 R2: -0.0153
2025-07-22 19:41:16,203 - INFO - Epoch [18/100], 训练损失: 1.3335, 验证损失: 1.4176, 验证 R2: -0.0324
2025-07-22 19:41:20,218 - INFO - Epoch [19/100], 训练损失: 1.3367, 验证损失: 1.3754, 验证 R2: -0.0017
2025-07-22 19:41:24,289 - INFO - Epoch [20/100], 训练损失: 1.3328, 验证损失: 1.3789, 验证 R2: -0.0042
2025-07-22 19:41:28,447 - INFO - Epoch [21/100], 训练损失: 1.3350, 验证损失: 1.3756, 验证 R2: -0.0018
2025-07-22 19:41:32,534 - INFO - Epoch [22/100], 训练损失: 1.3332, 验证损失: 1.3794, 验证 R2: -0.0045
2025-07-22 19:41:36,634 - INFO - Epoch [23/100], 训练损失: 1.3293, 验证损失: 1.3738, 验证 R2: -0.0005
2025-07-22 19:41:40,992 - INFO - Epoch [24/100], 训练损失: 1.3282, 验证损失: 1.3824, 验证 R2: -0.0068
2025-07-22 19:41:45,031 - INFO - Epoch [25/100], 训练损失: 1.3277, 验证损失: 1.3787, 验证 R2: -0.0040
2025-07-22 19:41:49,233 - INFO - Epoch [26/100], 训练损失: 1.3295, 验证损失: 1.3732, 验证 R2: -0.0001
2025-07-22 19:41:49,233 - INFO - 早停！验证损失在 10 个epoch内没有显著改善。
2025-07-22 19:41:49,239 - INFO - --- 模型训练完成 ---
2025-07-22 19:41:49,440 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 19:41:54,461 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 19:41:56,434 - INFO - Trial 5: 选择了 MLP 模型
2025-07-22 19:41:56,434 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:41:58,517 - INFO - Epoch [1/100], 训练损失: 4452.8798, 验证损失: 0.1996, 验证 R2: 0.8547
2025-07-22 19:42:00,349 - INFO - Epoch [2/100], 训练损失: 0.1440, 验证损失: 0.0363, 验证 R2: 0.9736
2025-07-22 19:42:02,243 - INFO - Epoch [3/100], 训练损失: 0.0432, 验证损失: 0.0116, 验证 R2: 0.9916
2025-07-22 19:42:04,222 - INFO - Epoch [4/100], 训练损失: 0.0436, 验证损失: 0.1726, 验证 R2: 0.8743
2025-07-22 19:42:06,148 - INFO - Epoch [5/100], 训练损失: 0.0431, 验证损失: 0.0407, 验证 R2: 0.9704
2025-07-22 19:42:08,027 - INFO - Epoch [6/100], 训练损失: 0.0536, 验证损失: 0.0121, 验证 R2: 0.9912
2025-07-22 19:42:09,911 - INFO - Epoch [7/100], 训练损失: 0.0421, 验证损失: 0.0069, 验证 R2: 0.9950
2025-07-22 19:42:11,904 - INFO - Epoch [8/100], 训练损失: 0.0941, 验证损失: 0.0036, 验证 R2: 0.9974
2025-07-22 19:42:13,774 - INFO - Epoch [9/100], 训练损失: 0.0477, 验证损失: 0.0293, 验证 R2: 0.9787
2025-07-22 19:42:15,824 - INFO - Epoch [10/100], 训练损失: 0.1432, 验证损失: 0.0518, 验证 R2: 0.9623
2025-07-22 19:42:17,898 - INFO - Epoch [11/100], 训练损失: 0.0555, 验证损失: 0.0650, 验证 R2: 0.9526
2025-07-22 19:42:19,877 - INFO - Epoch [12/100], 训练损失: 0.0576, 验证损失: 0.0187, 验证 R2: 0.9864
2025-07-22 19:42:21,712 - INFO - Epoch [13/100], 训练损失: 0.0397, 验证损失: 0.0329, 验证 R2: 0.9760
2025-07-22 19:42:23,498 - INFO - Epoch [14/100], 训练损失: 0.0471, 验证损失: 0.0285, 验证 R2: 0.9793
2025-07-22 19:42:25,009 - INFO - Epoch [15/100], 训练损失: 0.0038, 验证损失: 0.0188, 验证 R2: 0.9863
2025-07-22 19:42:26,539 - INFO - Epoch [16/100], 训练损失: 0.0082, 验证损失: 0.1627, 验证 R2: 0.8815
2025-07-22 19:42:28,010 - INFO - Epoch [17/100], 训练损失: 0.0087, 验证损失: 0.0010, 验证 R2: 0.9993
2025-07-22 19:42:29,594 - INFO - Epoch [18/100], 训练损失: 0.0070, 验证损失: 0.0060, 验证 R2: 0.9957
2025-07-22 19:42:31,082 - INFO - Epoch [19/100], 训练损失: 0.0071, 验证损失: 0.0087, 验证 R2: 0.9937
2025-07-22 19:42:32,704 - INFO - Epoch [20/100], 训练损失: 0.0070, 验证损失: 0.0120, 验证 R2: 0.9913
2025-07-22 19:42:34,256 - INFO - Epoch [21/100], 训练损失: 0.0069, 验证损失: 0.0015, 验证 R2: 0.9989
2025-07-22 19:42:35,876 - INFO - Epoch [22/100], 训练损失: 0.0061, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:42:37,420 - INFO - Epoch [23/100], 训练损失: 0.0046, 验证损失: 0.0081, 验证 R2: 0.9941
2025-07-22 19:42:38,909 - INFO - Epoch [24/100], 训练损失: 0.0070, 验证损失: 0.0039, 验证 R2: 0.9972
2025-07-22 19:42:40,405 - INFO - Epoch [25/100], 训练损失: 0.0057, 验证损失: 0.0163, 验证 R2: 0.9882
2025-07-22 19:42:41,909 - INFO - Epoch [26/100], 训练损失: 0.0068, 验证损失: 0.0013, 验证 R2: 0.9991
2025-07-22 19:42:43,413 - INFO - Epoch [27/100], 训练损失: 0.0044, 验证损失: 0.0067, 验证 R2: 0.9951
2025-07-22 19:42:44,933 - INFO - Epoch [28/100], 训练损失: 0.0057, 验证损失: 0.0020, 验证 R2: 0.9985
2025-07-22 19:42:46,426 - INFO - Epoch [29/100], 训练损失: 0.0006, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:42:47,915 - INFO - Epoch [30/100], 训练损失: 0.0019, 验证损失: 0.0015, 验证 R2: 0.9989
2025-07-22 19:42:49,407 - INFO - Epoch [31/100], 训练损失: 0.0012, 验证损失: 0.0151, 验证 R2: 0.9890
2025-07-22 19:42:50,913 - INFO - Epoch [32/100], 训练损失: 0.0016, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:42:52,398 - INFO - Epoch [33/100], 训练损失: 0.0013, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:42:54,006 - INFO - Epoch [34/100], 训练损失: 0.0013, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:42:55,536 - INFO - Epoch [35/100], 训练损失: 0.0014, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:42:57,096 - INFO - Epoch [36/100], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:42:58,693 - INFO - Epoch [37/100], 训练损失: 0.0005, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:43:00,205 - INFO - Epoch [38/100], 训练损失: 0.0005, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:43:01,780 - INFO - Epoch [39/100], 训练损失: 0.0005, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:43:03,338 - INFO - Epoch [40/100], 训练损失: 0.0005, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:43:04,929 - INFO - Epoch [41/100], 训练损失: 0.0004, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:43:06,523 - INFO - Epoch [42/100], 训练损失: 0.0005, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:43:08,087 - INFO - Epoch [43/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:43:09,589 - INFO - Epoch [44/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:11,306 - INFO - Epoch [45/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:12,929 - INFO - Epoch [46/100], 训练损失: 0.0002, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:43:14,447 - INFO - Epoch [47/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:16,067 - INFO - Epoch [48/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:43:17,803 - INFO - Epoch [49/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:19,486 - INFO - Epoch [50/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:21,184 - INFO - Epoch [51/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9997
2025-07-22 19:43:22,928 - INFO - Epoch [52/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:24,719 - INFO - Epoch [53/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:26,540 - INFO - Epoch [54/100], 训练损失: 0.0002, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:43:28,270 - INFO - Epoch [55/100], 训练损失: 0.0002, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:43:30,055 - INFO - Epoch [56/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:43:31,808 - INFO - Epoch [57/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:33,586 - INFO - Epoch [58/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:35,390 - INFO - Epoch [59/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:43:37,198 - INFO - Epoch [60/100], 训练损失: 0.0002, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:43:39,013 - INFO - Epoch [61/100], 训练损失: 0.0002, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:43:40,862 - INFO - Epoch [62/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:43:42,762 - INFO - Epoch [63/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:43:44,668 - INFO - Epoch [64/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:46,491 - INFO - Epoch [65/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:43:48,320 - INFO - Epoch [66/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:43:50,102 - INFO - Epoch [67/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:43:51,911 - INFO - Epoch [68/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:53,733 - INFO - Epoch [69/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:43:55,545 - INFO - Epoch [70/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:43:57,356 - INFO - Epoch [71/100], 训练损失: 0.0002, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:43:59,137 - INFO - Epoch [72/100], 训练损失: 0.0002, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:44:00,922 - INFO - Epoch [73/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:44:02,781 - INFO - Epoch [74/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:44:04,584 - INFO - Epoch [75/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9997
2025-07-22 19:44:06,383 - INFO - Epoch [76/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:44:08,193 - INFO - Epoch [77/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:44:10,010 - INFO - Epoch [78/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:44:11,836 - INFO - Epoch [79/100], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 19:44:11,836 - INFO - 早停！验证损失在 10 个epoch内没有显著改善。
2025-07-22 19:44:11,839 - INFO - --- 模型训练完成 ---
2025-07-22 19:44:11,981 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 19:44:15,354 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 19:44:16,878 - INFO - Trial 6: 选择了 FT-Transformer 模型
2025-07-22 19:44:16,878 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:44:20,683 - INFO - Epoch [1/100], 训练损失: 2.4940, 验证损失: 1.4815, 验证 R2: -0.0789
2025-07-22 19:44:24,298 - INFO - Epoch [2/100], 训练损失: 1.2058, 验证损失: 0.8233, 验证 R2: 0.4004
2025-07-22 19:44:27,899 - INFO - Epoch [3/100], 训练损失: 0.3638, 验证损失: 0.1665, 验证 R2: 0.8788
2025-07-22 19:44:31,508 - INFO - Epoch [4/100], 训练损失: 0.0815, 验证损失: 0.0456, 验证 R2: 0.9668
2025-07-22 19:44:35,161 - INFO - Epoch [5/100], 训练损失: 0.0180, 验证损失: 0.0103, 验证 R2: 0.9925
2025-07-22 19:44:38,740 - INFO - Epoch [6/100], 训练损失: 0.0064, 验证损失: 0.0045, 验证 R2: 0.9967
2025-07-22 19:44:42,360 - INFO - Epoch [7/100], 训练损失: 0.0042, 验证损失: 0.0036, 验证 R2: 0.9974
2025-07-22 19:44:46,103 - INFO - Epoch [8/100], 训练损失: 0.0035, 验证损失: 0.0021, 验证 R2: 0.9985
2025-07-22 19:44:49,979 - INFO - Epoch [9/100], 训练损失: 0.0028, 验证损失: 0.0029, 验证 R2: 0.9979
2025-07-22 19:44:53,602 - INFO - Epoch [10/100], 训练损失: 0.0025, 验证损失: 0.0015, 验证 R2: 0.9989
2025-07-22 19:44:57,207 - INFO - Epoch [11/100], 训练损失: 0.0024, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 19:45:00,829 - INFO - Epoch [12/100], 训练损失: 0.0022, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 19:45:04,523 - INFO - Epoch [13/100], 训练损失: 0.0020, 验证损失: 0.0010, 验证 R2: 0.9993
2025-07-22 19:45:08,232 - INFO - Epoch [14/100], 训练损失: 0.0019, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 19:45:12,018 - INFO - Epoch [15/100], 训练损失: 0.0018, 验证损失: 0.0017, 验证 R2: 0.9988
2025-07-22 19:45:15,727 - INFO - Epoch [16/100], 训练损失: 0.0017, 验证损失: 0.0018, 验证 R2: 0.9987
2025-07-22 19:45:19,138 - INFO - Epoch [17/100], 训练损失: 0.0017, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:45:22,482 - INFO - Epoch [18/100], 训练损失: 0.0016, 验证损失: 0.0009, 验证 R2: 0.9993
2025-07-22 19:45:25,754 - INFO - Epoch [19/100], 训练损失: 0.0015, 验证损失: 0.0010, 验证 R2: 0.9992
2025-07-22 19:45:28,916 - INFO - Epoch [20/100], 训练损失: 0.0015, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:45:32,075 - INFO - Epoch [21/100], 训练损失: 0.0014, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:45:35,278 - INFO - Epoch [22/100], 训练损失: 0.0014, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:45:38,377 - INFO - Epoch [23/100], 训练损失: 0.0014, 验证损失: 0.0013, 验证 R2: 0.9991
2025-07-22 19:45:41,507 - INFO - Epoch [24/100], 训练损失: 0.0013, 验证损失: 0.0006, 验证 R2: 0.9995
2025-07-22 19:45:44,671 - INFO - Epoch [25/100], 训练损失: 0.0013, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:45:47,810 - INFO - Epoch [26/100], 训练损失: 0.0012, 验证损失: 0.0021, 验证 R2: 0.9985
2025-07-22 19:45:51,006 - INFO - Epoch [27/100], 训练损失: 0.0012, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 19:45:54,620 - INFO - Epoch [28/100], 训练损失: 0.0013, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:45:58,294 - INFO - Epoch [29/100], 训练损失: 0.0011, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:46:02,004 - INFO - Epoch [30/100], 训练损失: 0.0012, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:46:05,752 - INFO - Epoch [31/100], 训练损失: 0.0011, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:46:09,491 - INFO - Epoch [32/100], 训练损失: 0.0011, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:46:13,223 - INFO - Epoch [33/100], 训练损失: 0.0011, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 19:46:16,932 - INFO - Epoch [34/100], 训练损失: 0.0011, 验证损失: 0.0019, 验证 R2: 0.9986
2025-07-22 19:46:20,623 - INFO - Epoch [35/100], 训练损失: 0.0010, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:46:24,446 - INFO - Epoch [36/100], 训练损失: 0.0010, 验证损失: 0.0033, 验证 R2: 0.9976
2025-07-22 19:46:28,266 - INFO - Epoch [37/100], 训练损失: 0.0010, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:46:32,180 - INFO - Epoch [38/100], 训练损失: 0.0003, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:46:36,080 - INFO - Epoch [39/100], 训练损失: 0.0004, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:46:39,830 - INFO - Epoch [40/100], 训练损失: 0.0004, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:46:43,445 - INFO - Epoch [41/100], 训练损失: 0.0004, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:46:47,234 - INFO - Epoch [42/100], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:46:51,068 - INFO - Epoch [43/100], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:46:54,736 - INFO - Epoch [44/100], 训练损失: 0.0004, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:46:58,416 - INFO - Epoch [45/100], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:47:01,976 - INFO - Epoch [46/100], 训练损失: 0.0003, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:47:05,650 - INFO - Epoch [47/100], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:47:09,328 - INFO - Epoch [48/100], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:47:13,035 - INFO - Epoch [49/100], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:47:16,649 - INFO - Epoch [50/100], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:47:20,233 - INFO - Epoch [51/100], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:47:23,934 - INFO - Epoch [52/100], 训练损失: 0.0004, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:47:27,633 - INFO - Epoch [53/100], 训练损失: 0.0003, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:47:30,858 - INFO - Epoch [54/100], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:47:33,944 - INFO - Epoch [55/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:47:37,103 - INFO - Epoch [56/100], 训练损失: 0.0004, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:47:40,293 - INFO - Epoch [57/100], 训练损失: 0.0003, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:47:43,617 - INFO - Epoch [58/100], 训练损失: 0.0002, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:47:47,082 - INFO - Epoch [59/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:47:50,680 - INFO - Epoch [60/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:47:54,339 - INFO - Epoch [61/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:47:54,339 - INFO - 早停！验证损失在 10 个epoch内没有显著改善。
2025-07-22 19:47:54,342 - INFO - --- 模型训练完成 ---
2025-07-22 19:47:54,480 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 19:47:58,960 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 19:48:02,021 - INFO - Trial 7: 选择了 MLP 模型
2025-07-22 19:48:02,022 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:48:03,258 - INFO - Epoch [1/100], 训练损失: 0.4930, 验证损失: 0.0203, 验证 R2: 0.9852
2025-07-22 19:48:04,334 - INFO - Epoch [2/100], 训练损失: 0.0681, 验证损失: 0.1524, 验证 R2: 0.8890
2025-07-22 19:48:05,317 - INFO - Epoch [3/100], 训练损失: 0.0338, 验证损失: 0.0185, 验证 R2: 0.9865
2025-07-22 19:48:06,284 - INFO - Epoch [4/100], 训练损失: 0.0239, 验证损失: 0.0020, 验证 R2: 0.9985
2025-07-22 19:48:07,260 - INFO - Epoch [5/100], 训练损失: 0.0200, 验证损失: 0.0075, 验证 R2: 0.9945
2025-07-22 19:48:08,237 - INFO - Epoch [6/100], 训练损失: 0.0150, 验证损失: 0.0096, 验证 R2: 0.9930
2025-07-22 19:48:09,206 - INFO - Epoch [7/100], 训练损失: 0.0127, 验证损失: 0.0061, 验证 R2: 0.9956
2025-07-22 19:48:10,168 - INFO - Epoch [8/100], 训练损失: 0.0101, 验证损失: 0.0017, 验证 R2: 0.9988
2025-07-22 19:48:11,184 - INFO - Epoch [9/100], 训练损失: 0.0087, 验证损失: 0.0013, 验证 R2: 0.9990
2025-07-22 19:48:12,164 - INFO - Epoch [10/100], 训练损失: 0.0090, 验证损失: 0.0030, 验证 R2: 0.9978
2025-07-22 19:48:13,168 - INFO - Epoch [11/100], 训练损失: 0.0066, 验证损失: 0.0011, 验证 R2: 0.9992
2025-07-22 19:48:14,208 - INFO - Epoch [12/100], 训练损失: 0.0061, 验证损失: 0.0027, 验证 R2: 0.9980
2025-07-22 19:48:15,223 - INFO - Epoch [13/100], 训练损失: 0.0060, 验证损失: 0.0030, 验证 R2: 0.9978
2025-07-22 19:48:16,214 - INFO - Epoch [14/100], 训练损失: 0.0059, 验证损失: 0.0017, 验证 R2: 0.9988
2025-07-22 19:48:17,185 - INFO - Epoch [15/100], 训练损失: 0.0050, 验证损失: 0.0015, 验证 R2: 0.9989
2025-07-22 19:48:18,153 - INFO - Epoch [16/100], 训练损失: 0.0051, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:48:19,135 - INFO - Epoch [17/100], 训练损失: 0.0045, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:48:20,117 - INFO - Epoch [18/100], 训练损失: 0.0045, 验证损失: 0.0042, 验证 R2: 0.9970
2025-07-22 19:48:21,163 - INFO - Epoch [19/100], 训练损失: 0.0042, 验证损失: 0.0076, 验证 R2: 0.9945
2025-07-22 19:48:22,131 - INFO - Epoch [20/100], 训练损失: 0.0042, 验证损失: 0.0055, 验证 R2: 0.9960
2025-07-22 19:48:23,122 - INFO - Epoch [21/100], 训练损失: 0.0040, 验证损失: 0.0011, 验证 R2: 0.9992
2025-07-22 19:48:24,088 - INFO - Epoch [22/100], 训练损失: 0.0040, 验证损失: 0.0025, 验证 R2: 0.9982
2025-07-22 19:48:25,058 - INFO - Epoch [23/100], 训练损失: 0.0006, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:48:26,040 - INFO - Epoch [24/100], 训练损失: 0.0013, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:48:27,042 - INFO - Epoch [25/100], 训练损失: 0.0012, 验证损失: 0.0009, 验证 R2: 0.9993
2025-07-22 19:48:28,064 - INFO - Epoch [26/100], 训练损失: 0.0011, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 19:48:29,065 - INFO - Epoch [27/100], 训练损失: 0.0010, 验证损失: 0.0011, 验证 R2: 0.9992
2025-07-22 19:48:30,069 - INFO - Epoch [28/100], 训练损失: 0.0012, 验证损失: 0.0046, 验证 R2: 0.9966
2025-07-22 19:48:31,072 - INFO - Epoch [29/100], 训练损失: 0.0011, 验证损失: 0.0015, 验证 R2: 0.9989
2025-07-22 19:48:32,060 - INFO - Epoch [30/100], 训练损失: 0.0011, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:48:33,079 - INFO - Epoch [31/100], 训练损失: 0.0003, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:48:34,089 - INFO - Epoch [32/100], 训练损失: 0.0004, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:48:35,091 - INFO - Epoch [33/100], 训练损失: 0.0004, 验证损失: 0.0011, 验证 R2: 0.9992
2025-07-22 19:48:36,127 - INFO - Epoch [34/100], 训练损失: 0.0004, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:37,289 - INFO - Epoch [35/100], 训练损失: 0.0005, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:38,356 - INFO - Epoch [36/100], 训练损失: 0.0004, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:48:39,374 - INFO - Epoch [37/100], 训练损失: 0.0004, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:48:40,427 - INFO - Epoch [38/100], 训练损失: 0.0005, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:48:41,457 - INFO - Epoch [39/100], 训练损失: 0.0003, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:42,512 - INFO - Epoch [40/100], 训练损失: 0.0004, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:48:43,519 - INFO - Epoch [41/100], 训练损失: 0.0004, 验证损失: 0.0013, 验证 R2: 0.9991
2025-07-22 19:48:44,504 - INFO - Epoch [42/100], 训练损失: 0.0002, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:48:45,652 - INFO - Epoch [43/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:46,675 - INFO - Epoch [44/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:47,726 - INFO - Epoch [45/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:48,728 - INFO - Epoch [46/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:49,727 - INFO - Epoch [47/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:50,710 - INFO - Epoch [48/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:51,706 - INFO - Epoch [49/100], 训练损失: 0.0002, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:48:52,747 - INFO - Epoch [50/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:53,741 - INFO - Epoch [51/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:54,755 - INFO - Epoch [52/100], 训练损失: 0.0002, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:48:55,781 - INFO - Epoch [53/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:56,798 - INFO - Epoch [54/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:57,815 - INFO - Epoch [55/100], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:58,808 - INFO - Epoch [56/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:48:59,832 - INFO - Epoch [57/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:00,813 - INFO - Epoch [58/100], 训练损失: 0.0001, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:49:01,813 - INFO - Epoch [59/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:02,783 - INFO - Epoch [60/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:03,793 - INFO - Epoch [61/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:04,776 - INFO - Epoch [62/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:05,766 - INFO - Epoch [63/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:06,745 - INFO - Epoch [64/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:07,753 - INFO - Epoch [65/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:08,722 - INFO - Epoch [66/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9997
2025-07-22 19:49:09,724 - INFO - Epoch [67/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:10,724 - INFO - Epoch [68/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:11,719 - INFO - Epoch [69/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:12,727 - INFO - Epoch [70/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9997
2025-07-22 19:49:13,738 - INFO - Epoch [71/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:14,755 - INFO - Epoch [72/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9997
2025-07-22 19:49:15,726 - INFO - Epoch [73/100], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:49:15,726 - INFO - 早停！验证损失在 10 个epoch内没有显著改善。
2025-07-22 19:49:15,729 - INFO - --- 模型训练完成 ---
2025-07-22 19:49:15,875 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 19:49:21,216 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 19:49:22,751 - INFO - Trial 8: 选择了 MLP 模型
2025-07-22 19:49:22,752 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:49:24,265 - INFO - Epoch [1/100], 训练损失: 0.3985, 验证损失: 0.0821, 验证 R2: 0.9402
2025-07-22 19:49:25,718 - INFO - Epoch [2/100], 训练损失: 0.0160, 验证损失: 0.0108, 验证 R2: 0.9922
2025-07-22 19:49:27,085 - INFO - Epoch [3/100], 训练损失: 0.0166, 验证损失: 0.0131, 验证 R2: 0.9905
2025-07-22 19:49:28,353 - INFO - Epoch [4/100], 训练损失: 0.0135, 验证损失: 0.0065, 验证 R2: 0.9953
2025-07-22 19:49:29,685 - INFO - Epoch [5/100], 训练损失: 0.0111, 验证损失: 0.0069, 验证 R2: 0.9950
2025-07-22 19:49:31,020 - INFO - Epoch [6/100], 训练损失: 0.0096, 验证损失: 0.0040, 验证 R2: 0.9971
2025-07-22 19:49:32,274 - INFO - Epoch [7/100], 训练损失: 0.0078, 验证损失: 0.0162, 验证 R2: 0.9882
2025-07-22 19:49:33,546 - INFO - Epoch [8/100], 训练损失: 0.0078, 验证损失: 0.0031, 验证 R2: 0.9978
2025-07-22 19:49:34,823 - INFO - Epoch [9/100], 训练损失: 0.0071, 验证损失: 0.0033, 验证 R2: 0.9976
2025-07-22 19:49:36,128 - INFO - Epoch [10/100], 训练损失: 0.0055, 验证损失: 0.0197, 验证 R2: 0.9857
2025-07-22 19:49:37,408 - INFO - Epoch [11/100], 训练损失: 0.0045, 验证损失: 0.0020, 验证 R2: 0.9985
2025-07-22 19:49:38,655 - INFO - Epoch [12/100], 训练损失: 0.0056, 验证损失: 0.0098, 验证 R2: 0.9929
2025-07-22 19:49:39,958 - INFO - Epoch [13/100], 训练损失: 0.0041, 验证损失: 0.0123, 验证 R2: 0.9910
2025-07-22 19:49:41,286 - INFO - Epoch [14/100], 训练损失: 0.0047, 验证损失: 0.0178, 验证 R2: 0.9871
2025-07-22 19:49:42,536 - INFO - Epoch [15/100], 训练损失: 0.0037, 验证损失: 0.0076, 验证 R2: 0.9945
2025-07-22 19:49:43,801 - INFO - Epoch [16/100], 训练损失: 0.0042, 验证损失: 0.0033, 验证 R2: 0.9976
2025-07-22 19:49:45,042 - INFO - Epoch [17/100], 训练损失: 0.0034, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 19:49:46,387 - INFO - Epoch [18/100], 训练损失: 0.0032, 验证损失: 0.0046, 验证 R2: 0.9966
2025-07-22 19:49:47,740 - INFO - Epoch [19/100], 训练损失: 0.0033, 验证损失: 0.0016, 验证 R2: 0.9988
2025-07-22 19:49:49,052 - INFO - Epoch [20/100], 训练损失: 0.0030, 验证损失: 0.0088, 验证 R2: 0.9936
2025-07-22 19:49:50,319 - INFO - Epoch [21/100], 训练损失: 0.0028, 验证损失: 0.0022, 验证 R2: 0.9984
2025-07-22 19:49:51,641 - INFO - Epoch [22/100], 训练损失: 0.0029, 验证损失: 0.0013, 验证 R2: 0.9990
2025-07-22 19:49:53,152 - INFO - Epoch [23/100], 训练损失: 0.0031, 验证损失: 0.0027, 验证 R2: 0.9980
2025-07-22 19:49:54,821 - INFO - Epoch [24/100], 训练损失: 0.0006, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 19:49:56,418 - INFO - Epoch [25/100], 训练损失: 0.0009, 验证损失: 0.0009, 验证 R2: 0.9993
2025-07-22 19:49:58,145 - INFO - Epoch [26/100], 训练损失: 0.0009, 验证损失: 0.0010, 验证 R2: 0.9992
2025-07-22 19:49:59,713 - INFO - Epoch [27/100], 训练损失: 0.0009, 验证损失: 0.0023, 验证 R2: 0.9983
2025-07-22 19:50:01,568 - INFO - Epoch [28/100], 训练损失: 0.0008, 验证损失: 0.0010, 验证 R2: 0.9993
2025-07-22 19:50:03,578 - INFO - Epoch [29/100], 训练损失: 0.0008, 验证损失: 0.0017, 验证 R2: 0.9988
2025-07-22 19:50:05,385 - INFO - Epoch [30/100], 训练损失: 0.0008, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:50:07,284 - INFO - Epoch [31/100], 训练损失: 0.0007, 验证损失: 0.0010, 验证 R2: 0.9993
2025-07-22 19:50:09,205 - INFO - Epoch [32/100], 训练损失: 0.0008, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:50:11,061 - INFO - Epoch [33/100], 训练损失: 0.0008, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 19:50:12,779 - INFO - Epoch [34/100], 训练损失: 0.0006, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:50:14,538 - INFO - Epoch [35/100], 训练损失: 0.0008, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:50:16,174 - INFO - Epoch [36/100], 训练损失: 0.0007, 验证损失: 0.0009, 验证 R2: 0.9993
2025-07-22 19:50:17,827 - INFO - Epoch [37/100], 训练损失: 0.0007, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:50:19,699 - INFO - Epoch [38/100], 训练损失: 0.0007, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:50:21,611 - INFO - Epoch [39/100], 训练损失: 0.0006, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:50:23,600 - INFO - Epoch [40/100], 训练损失: 0.0007, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:50:25,137 - INFO - Epoch [41/100], 训练损失: 0.0007, 验证损失: 0.0009, 验证 R2: 0.9994
2025-07-22 19:50:26,756 - INFO - Epoch [42/100], 训练损失: 0.0006, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:50:28,359 - INFO - Epoch [43/100], 训练损失: 0.0008, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:50:29,903 - INFO - Epoch [44/100], 训练损失: 0.0002, 验证损失: 0.0009, 验证 R2: 0.9993
2025-07-22 19:50:31,514 - INFO - Epoch [45/100], 训练损失: 0.0003, 验证损失: 0.0009, 验证 R2: 0.9994
2025-07-22 19:50:33,107 - INFO - Epoch [46/100], 训练损失: 0.0002, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:50:34,661 - INFO - Epoch [47/100], 训练损失: 0.0002, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:50:34,662 - INFO - 早停！验证损失在 10 个epoch内没有显著改善。
2025-07-22 19:50:34,664 - INFO - --- 模型训练完成 ---
2025-07-22 19:50:34,871 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 19:50:37,283 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 19:50:39,424 - INFO - Trial 9: 选择了 FT-Transformer 模型
2025-07-22 19:50:39,424 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:50:44,336 - INFO - Epoch [1/100], 训练损失: 2.1819, 验证损失: 1.3302, 验证 R2: 0.0312
2025-07-22 19:50:49,017 - INFO - Epoch [2/100], 训练损失: 0.7688, 验证损失: 0.3060, 验证 R2: 0.7771
2025-07-22 19:50:53,900 - INFO - Epoch [3/100], 训练损失: 0.1439, 验证损失: 0.0619, 验证 R2: 0.9549
2025-07-22 19:50:58,861 - INFO - Epoch [4/100], 训练损失: 0.0277, 验证损失: 0.0123, 验证 R2: 0.9910
2025-07-22 19:51:03,888 - INFO - Epoch [5/100], 训练损失: 0.0076, 验证损失: 0.0053, 验证 R2: 0.9962
2025-07-22 19:51:08,834 - INFO - Epoch [6/100], 训练损失: 0.0045, 验证损失: 0.0091, 验证 R2: 0.9934
2025-07-22 19:51:13,246 - INFO - Epoch [7/100], 训练损失: 0.0032, 验证损失: 0.0024, 验证 R2: 0.9983
2025-07-22 19:51:17,798 - INFO - Epoch [8/100], 训练损失: 0.0028, 验证损失: 0.0021, 验证 R2: 0.9984
2025-07-22 19:51:22,452 - INFO - Epoch [9/100], 训练损失: 0.0023, 验证损失: 0.0035, 验证 R2: 0.9974
2025-07-22 19:51:26,901 - INFO - Epoch [10/100], 训练损失: 0.0019, 验证损失: 0.0013, 验证 R2: 0.9991
2025-07-22 19:51:31,633 - INFO - Epoch [11/100], 训练损失: 0.0017, 验证损失: 0.0013, 验证 R2: 0.9991
2025-07-22 19:51:36,121 - INFO - Epoch [12/100], 训练损失: 0.0016, 验证损失: 0.0020, 验证 R2: 0.9986
2025-07-22 19:51:39,992 - INFO - Epoch [13/100], 训练损失: 0.0014, 验证损失: 0.0020, 验证 R2: 0.9985
2025-07-22 19:51:43,695 - INFO - Epoch [14/100], 训练损失: 0.0014, 验证损失: 0.0009, 验证 R2: 0.9993
2025-07-22 19:51:47,620 - INFO - Epoch [15/100], 训练损失: 0.0013, 验证损失: 0.0009, 验证 R2: 0.9994
2025-07-22 19:51:51,460 - INFO - Epoch [16/100], 训练损失: 0.0012, 验证损失: 0.0006, 验证 R2: 0.9995
2025-07-22 19:51:55,400 - INFO - Epoch [17/100], 训练损失: 0.0011, 验证损失: 0.0006, 验证 R2: 0.9995
2025-07-22 19:51:59,251 - INFO - Epoch [18/100], 训练损失: 0.0011, 验证损失: 0.0011, 验证 R2: 0.9992
2025-07-22 19:52:03,203 - INFO - Epoch [19/100], 训练损失: 0.0011, 验证损失: 0.0039, 验证 R2: 0.9972
2025-07-22 19:52:07,110 - INFO - Epoch [20/100], 训练损失: 0.0011, 验证损失: 0.0010, 验证 R2: 0.9993
2025-07-22 19:52:10,982 - INFO - Epoch [21/100], 训练损失: 0.0010, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:52:14,829 - INFO - Epoch [22/100], 训练损失: 0.0009, 验证损失: 0.0018, 验证 R2: 0.9987
2025-07-22 19:52:18,753 - INFO - Epoch [23/100], 训练损失: 0.0010, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:52:22,670 - INFO - Epoch [24/100], 训练损失: 0.0009, 验证损失: 0.0017, 验证 R2: 0.9988
2025-07-22 19:52:26,593 - INFO - Epoch [25/100], 训练损失: 0.0009, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:52:30,425 - INFO - Epoch [26/100], 训练损失: 0.0009, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:52:34,318 - INFO - Epoch [27/100], 训练损失: 0.0008, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 19:52:38,344 - INFO - Epoch [28/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9997
2025-07-22 19:52:42,321 - INFO - Epoch [29/100], 训练损失: 0.0004, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:52:46,371 - INFO - Epoch [30/100], 训练损失: 0.0004, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:52:50,589 - INFO - Epoch [31/100], 训练损失: 0.0003, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:52:54,778 - INFO - Epoch [32/100], 训练损失: 0.0004, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:52:58,866 - INFO - Epoch [33/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:53:03,040 - INFO - Epoch [34/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:53:07,265 - INFO - Epoch [35/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:53:11,607 - INFO - Epoch [36/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:53:15,796 - INFO - Epoch [37/100], 训练损失: 0.0003, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:53:20,016 - INFO - Epoch [38/100], 训练损失: 0.0003, 验证损失: 0.0006, 验证 R2: 0.9995
2025-07-22 19:53:24,289 - INFO - Epoch [39/100], 训练损失: 0.0003, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:53:28,698 - INFO - Epoch [40/100], 训练损失: 0.0003, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:53:33,125 - INFO - Epoch [41/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:53:37,683 - INFO - Epoch [42/100], 训练损失: 0.0003, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:53:42,014 - INFO - Epoch [43/100], 训练损失: 0.0003, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:53:46,352 - INFO - Epoch [44/100], 训练损失: 0.0003, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:53:50,641 - INFO - Epoch [45/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:53:54,924 - INFO - Epoch [46/100], 训练损失: 0.0003, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:53:59,195 - INFO - Epoch [47/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:54:03,498 - INFO - Epoch [48/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:54:07,782 - INFO - Epoch [49/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:54:12,027 - INFO - Epoch [50/100], 训练损失: 0.0003, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:54:16,258 - INFO - Epoch [51/100], 训练损失: 0.0003, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:54:20,572 - INFO - Epoch [52/100], 训练损失: 0.0003, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:54:24,870 - INFO - Epoch [53/100], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:54:29,105 - INFO - Epoch [54/100], 训练损失: 0.0002, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:54:33,337 - INFO - Epoch [55/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:54:37,644 - INFO - Epoch [56/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:54:41,933 - INFO - Epoch [57/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:54:46,154 - INFO - Epoch [58/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:54:50,446 - INFO - Epoch [59/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:54:54,748 - INFO - Epoch [60/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:54:59,101 - INFO - Epoch [61/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:55:03,276 - INFO - Epoch [62/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:55:07,439 - INFO - Epoch [63/100], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:55:11,720 - INFO - Epoch [64/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:55:16,020 - INFO - Epoch [65/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:55:20,237 - INFO - Epoch [66/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:55:24,421 - INFO - Epoch [67/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:55:28,735 - INFO - Epoch [68/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:55:33,031 - INFO - Epoch [69/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:55:37,280 - INFO - Epoch [70/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:55:41,515 - INFO - Epoch [71/100], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 19:55:45,731 - INFO - Epoch [72/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:55:50,076 - INFO - Epoch [73/100], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:55:54,288 - INFO - Epoch [74/100], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:55:58,462 - INFO - Epoch [75/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:56:02,766 - INFO - Epoch [76/100], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 19:56:07,059 - INFO - Epoch [77/100], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 19:56:11,350 - INFO - Epoch [78/100], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:56:15,634 - INFO - Epoch [79/100], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 19:56:19,877 - INFO - Epoch [80/100], 训练损失: 0.0001, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 19:56:24,185 - INFO - Epoch [81/100], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 19:56:24,185 - INFO - 早停！验证损失在 10 个epoch内没有显著改善。
2025-07-22 19:56:24,188 - INFO - --- 模型训练完成 ---
2025-07-22 19:56:24,334 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 19:56:51,096 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 19:56:56,396 - INFO - 
--- Optuna 超参数优化完成 ---
2025-07-22 19:56:56,396 - INFO - 最佳 Trial 的值 (验证损失): 0.0002
2025-07-22 19:56:56,396 - INFO - 最佳超参数: {'lr': 1.2640990989922087e-05, 'optimizer': 'RMSprop', 'model_type': 'FTTransformer', 'ftt_dim': 64, 'ftt_depth': 5, 'ftt_heads': 4, 'ftt_attn_dropout': 0.14665717628795816, 'ftt_ff_dropout': 0.26660956677899755}
2025-07-22 19:56:56,396 - INFO - 
Optuna found best hyperparameters: {'lr': 1.2640990989922087e-05, 'optimizer': 'RMSprop', 'model_type': 'FTTransformer', 'ftt_dim': 64, 'ftt_depth': 5, 'ftt_heads': 4, 'ftt_attn_dropout': 0.14665717628795816, 'ftt_ff_dropout': 0.26660956677899755}
2025-07-22 19:56:56,407 - INFO - 
Final model structure built with best hyperparameters:
2025-07-22 19:56:56,407 - INFO - FTTransformer(
  (numerical_embeds): ModuleList(
    (0-11): 12 x Linear(in_features=1, out_features=64, bias=True)
  )
  (pos_embedding): PositionalEncoding()
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0-4): 5 x TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.14665717628795816, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.14665717628795816, inplace=False)
        (dropout2): Dropout(p=0.14665717628795816, inplace=False)
      )
    )
  )
  (mlp_head): Sequential(
    (0): Linear(in_features=64, out_features=256, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.26660956677899755, inplace=False)
    (3): Linear(in_features=256, out_features=128, bias=True)
    (4): ReLU()
    (5): Dropout(p=0.26660956677899755, inplace=False)
    (6): Linear(in_features=128, out_features=1, bias=True)
  )
)
2025-07-22 19:56:56,409 - INFO - 
Final model's loss function: MSELoss
2025-07-22 19:56:56,409 - INFO - Final model's optimizer: RMSprop, Learning Rate: 1.2640990989922087e-05
2025-07-22 19:56:56,409 - INFO - Final model's learning rate scheduler: ReduceLROnPlateau
2025-07-22 19:56:56,409 - INFO - 
--- Phase 3: Model Training and Tuning (using best hyperparameters) ---
2025-07-22 19:56:56,409 - INFO - 
--- 模型训练开始 ---
2025-07-22 19:57:00,893 - INFO - Epoch [1/200], 训练损失: 2.5165, 验证损失: 1.3762, 验证 R2: -0.0023
2025-07-22 19:57:05,155 - INFO - Epoch [2/200], 训练损失: 0.8305, 验证损失: 0.3998, 验证 R2: 0.7088
2025-07-22 19:57:09,407 - INFO - Epoch [3/200], 训练损失: 0.2111, 验证损失: 0.1077, 验证 R2: 0.9216
2025-07-22 19:57:13,671 - INFO - Epoch [4/200], 训练损失: 0.0491, 验证损失: 0.0181, 验证 R2: 0.9868
2025-07-22 19:57:17,941 - INFO - Epoch [5/200], 训练损失: 0.0095, 验证损失: 0.0059, 验证 R2: 0.9957
2025-07-22 19:57:22,145 - INFO - Epoch [6/200], 训练损失: 0.0045, 验证损失: 0.0088, 验证 R2: 0.9936
2025-07-22 19:57:26,494 - INFO - Epoch [7/200], 训练损失: 0.0032, 验证损失: 0.0022, 验证 R2: 0.9984
2025-07-22 19:57:30,824 - INFO - Epoch [8/200], 训练损失: 0.0026, 验证损失: 0.0023, 验证 R2: 0.9983
2025-07-22 19:57:35,211 - INFO - Epoch [9/200], 训练损失: 0.0022, 验证损失: 0.0026, 验证 R2: 0.9981
2025-07-22 19:57:39,494 - INFO - Epoch [10/200], 训练损失: 0.0020, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 19:57:43,144 - INFO - Epoch [11/200], 训练损失: 0.0018, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 19:57:46,742 - INFO - Epoch [12/200], 训练损失: 0.0016, 验证损失: 0.0049, 验证 R2: 0.9964
2025-07-22 19:57:50,303 - INFO - Epoch [13/200], 训练损失: 0.0016, 验证损失: 0.0009, 验证 R2: 0.9994
2025-07-22 19:57:53,907 - INFO - Epoch [14/200], 训练损失: 0.0013, 验证损失: 0.0018, 验证 R2: 0.9987
2025-07-22 19:57:57,511 - INFO - Epoch [15/200], 训练损失: 0.0014, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:58:01,153 - INFO - Epoch [16/200], 训练损失: 0.0013, 验证损失: 0.0006, 验证 R2: 0.9995
2025-07-22 19:58:04,776 - INFO - Epoch [17/200], 训练损失: 0.0012, 验证损失: 0.0019, 验证 R2: 0.9986
2025-07-22 19:58:08,481 - INFO - Epoch [18/200], 训练损失: 0.0013, 验证损失: 0.0019, 验证 R2: 0.9986
2025-07-22 19:58:12,215 - INFO - Epoch [19/200], 训练损失: 0.0011, 验证损失: 0.0021, 验证 R2: 0.9985
2025-07-22 19:58:16,204 - INFO - Epoch [20/200], 训练损失: 0.0011, 验证损失: 0.0011, 验证 R2: 0.9992
2025-07-22 19:58:20,511 - INFO - Epoch [21/200], 训练损失: 0.0010, 验证损失: 0.0016, 验证 R2: 0.9989
2025-07-22 19:58:24,645 - INFO - Epoch [22/200], 训练损失: 0.0010, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 19:58:28,764 - INFO - Epoch [23/200], 训练损失: 0.0010, 验证损失: 0.0006, 验证 R2: 0.9996
2025-07-22 19:58:32,718 - INFO - Epoch [24/200], 训练损失: 0.0010, 验证损失: 0.0010, 验证 R2: 0.9993
2025-07-22 19:58:37,196 - INFO - Epoch [25/200], 训练损失: 0.0009, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 19:58:41,642 - INFO - Epoch [26/200], 训练损失: 0.0010, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:58:45,888 - INFO - Epoch [27/200], 训练损失: 0.0009, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 19:58:50,047 - INFO - Epoch [28/200], 训练损失: 0.0008, 验证损失: 0.0025, 验证 R2: 0.9982
2025-07-22 19:58:54,231 - INFO - Epoch [29/200], 训练损失: 0.0009, 验证损失: 0.0033, 验证 R2: 0.9976
2025-07-22 19:58:58,346 - INFO - Epoch [30/200], 训练损失: 0.0008, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 19:59:02,628 - INFO - Epoch [31/200], 训练损失: 0.0008, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:59:07,042 - INFO - Epoch [32/200], 训练损失: 0.0008, 验证损失: 0.0015, 验证 R2: 0.9989
2025-07-22 19:59:11,020 - INFO - Epoch [33/200], 训练损失: 0.0008, 验证损失: 0.0029, 验证 R2: 0.9979
2025-07-22 19:59:15,169 - INFO - Epoch [34/200], 训练损失: 0.0007, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 19:59:19,256 - INFO - Epoch [35/200], 训练损失: 0.0007, 验证损失: 0.0013, 验证 R2: 0.9990
2025-07-22 19:59:23,301 - INFO - Epoch [36/200], 训练损失: 0.0007, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:59:27,795 - INFO - Epoch [37/200], 训练损失: 0.0006, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:59:32,408 - INFO - Epoch [38/200], 训练损失: 0.0008, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:59:36,562 - INFO - Epoch [39/200], 训练损失: 0.0007, 验证损失: 0.0010, 验证 R2: 0.9992
2025-07-22 19:59:40,463 - INFO - Epoch [40/200], 训练损失: 0.0007, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 19:59:44,344 - INFO - Epoch [41/200], 训练损失: 0.0007, 验证损失: 0.0010, 验证 R2: 0.9993
2025-07-22 19:59:48,125 - INFO - Epoch [42/200], 训练损失: 0.0007, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:59:51,932 - INFO - Epoch [43/200], 训练损失: 0.0006, 验证损失: 0.0006, 验证 R2: 0.9995
2025-07-22 19:59:55,679 - INFO - Epoch [44/200], 训练损失: 0.0007, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 19:59:59,440 - INFO - Epoch [45/200], 训练损失: 0.0006, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:00:03,215 - INFO - Epoch [46/200], 训练损失: 0.0006, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:00:07,210 - INFO - Epoch [47/200], 训练损失: 0.0006, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 20:00:11,078 - INFO - Epoch [48/200], 训练损失: 0.0006, 验证损失: 0.0020, 验证 R2: 0.9985
2025-07-22 20:00:15,140 - INFO - Epoch [49/200], 训练损失: 0.0006, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:00:19,409 - INFO - Epoch [50/200], 训练损失: 0.0006, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 20:00:23,733 - INFO - Epoch [51/200], 训练损失: 0.0006, 验证损失: 0.0008, 验证 R2: 0.9994
2025-07-22 20:00:28,142 - INFO - Epoch [52/200], 训练损失: 0.0006, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:00:32,327 - INFO - Epoch [53/200], 训练损失: 0.0005, 验证损失: 0.0013, 验证 R2: 0.9991
2025-07-22 20:00:36,619 - INFO - Epoch [54/200], 训练损失: 0.0005, 验证损失: 0.0012, 验证 R2: 0.9991
2025-07-22 20:00:40,778 - INFO - Epoch [55/200], 训练损失: 0.0006, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:00:44,866 - INFO - Epoch [56/200], 训练损失: 0.0005, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:00:48,883 - INFO - Epoch [57/200], 训练损失: 0.0005, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:00:52,831 - INFO - Epoch [58/200], 训练损失: 0.0005, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 20:00:56,951 - INFO - Epoch [59/200], 训练损失: 0.0005, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 20:01:01,002 - INFO - Epoch [60/200], 训练损失: 0.0005, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 20:01:04,991 - INFO - Epoch [61/200], 训练损失: 0.0005, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:01:08,937 - INFO - Epoch [62/200], 训练损失: 0.0005, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:01:12,869 - INFO - Epoch [63/200], 训练损失: 0.0005, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:01:16,845 - INFO - Epoch [64/200], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:01:20,864 - INFO - Epoch [65/200], 训练损失: 0.0005, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:01:24,871 - INFO - Epoch [66/200], 训练损失: 0.0004, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 20:01:28,854 - INFO - Epoch [67/200], 训练损失: 0.0005, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:01:32,896 - INFO - Epoch [68/200], 训练损失: 0.0004, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:01:37,025 - INFO - Epoch [69/200], 训练损失: 0.0005, 验证损失: 0.0009, 验证 R2: 0.9994
2025-07-22 20:01:41,111 - INFO - Epoch [70/200], 训练损失: 0.0004, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 20:01:45,188 - INFO - Epoch [71/200], 训练损失: 0.0005, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:01:49,332 - INFO - Epoch [72/200], 训练损失: 0.0004, 验证损失: 0.0006, 验证 R2: 0.9995
2025-07-22 20:01:53,406 - INFO - Epoch [73/200], 训练损失: 0.0005, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 20:01:57,384 - INFO - Epoch [74/200], 训练损失: 0.0004, 验证损失: 0.0005, 验证 R2: 0.9997
2025-07-22 20:02:01,434 - INFO - Epoch [75/200], 训练损失: 0.0004, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 20:02:05,579 - INFO - Epoch [76/200], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9997
2025-07-22 20:02:09,683 - INFO - Epoch [77/200], 训练损失: 0.0004, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:02:13,775 - INFO - Epoch [78/200], 训练损失: 0.0004, 验证损失: 0.0014, 验证 R2: 0.9990
2025-07-22 20:02:17,979 - INFO - Epoch [79/200], 训练损失: 0.0004, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:02:22,301 - INFO - Epoch [80/200], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:02:26,489 - INFO - Epoch [81/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:02:30,658 - INFO - Epoch [82/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:02:34,973 - INFO - Epoch [83/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:02:39,251 - INFO - Epoch [84/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:02:43,543 - INFO - Epoch [85/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:02:47,745 - INFO - Epoch [86/200], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:02:51,948 - INFO - Epoch [87/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:02:56,302 - INFO - Epoch [88/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:03:00,445 - INFO - Epoch [89/200], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:03:04,610 - INFO - Epoch [90/200], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:03:08,852 - INFO - Epoch [91/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:03:13,012 - INFO - Epoch [92/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:03:17,150 - INFO - Epoch [93/200], 训练损失: 0.0002, 验证损失: 0.0006, 验证 R2: 0.9995
2025-07-22 20:03:21,309 - INFO - Epoch [94/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:03:25,577 - INFO - Epoch [95/200], 训练损失: 0.0002, 验证损失: 0.0005, 验证 R2: 0.9996
2025-07-22 20:03:29,916 - INFO - Epoch [96/200], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:03:34,263 - INFO - Epoch [97/200], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:03:38,620 - INFO - Epoch [98/200], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:03:43,045 - INFO - Epoch [99/200], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:03:47,438 - INFO - Epoch [100/200], 训练损失: 0.0002, 验证损失: 0.0007, 验证 R2: 0.9995
2025-07-22 20:03:51,580 - INFO - Epoch [101/200], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:03:55,920 - INFO - Epoch [102/200], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:04:00,231 - INFO - Epoch [103/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:04:04,617 - INFO - Epoch [104/200], 训练损失: 0.0002, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:04:08,868 - INFO - Epoch [105/200], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:04:13,204 - INFO - Epoch [106/200], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:04:17,658 - INFO - Epoch [107/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:04:21,967 - INFO - Epoch [108/200], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:04:26,289 - INFO - Epoch [109/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:04:30,674 - INFO - Epoch [110/200], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:04:34,989 - INFO - Epoch [111/200], 训练损失: 0.0002, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:04:39,321 - INFO - Epoch [112/200], 训练损失: 0.0001, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:04:43,643 - INFO - Epoch [113/200], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:04:47,902 - INFO - Epoch [114/200], 训练损失: 0.0002, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:04:52,289 - INFO - Epoch [115/200], 训练损失: 0.0002, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:04:56,612 - INFO - Epoch [116/200], 训练损失: 0.0002, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:05:00,922 - INFO - Epoch [117/200], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:05:05,164 - INFO - Epoch [118/200], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:05:09,515 - INFO - Epoch [119/200], 训练损失: 0.0002, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:05:13,915 - INFO - Epoch [120/200], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:05:18,206 - INFO - Epoch [121/200], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:05:22,574 - INFO - Epoch [122/200], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:05:27,094 - INFO - Epoch [123/200], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:05:31,528 - INFO - Epoch [124/200], 训练损失: 0.0002, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:05:35,888 - INFO - Epoch [125/200], 训练损失: 0.0001, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:05:40,136 - INFO - Epoch [126/200], 训练损失: 0.0001, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:05:44,519 - INFO - Epoch [127/200], 训练损失: 0.0001, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:05:48,758 - INFO - Epoch [128/200], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:05:53,071 - INFO - Epoch [129/200], 训练损失: 0.0002, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:05:57,311 - INFO - Epoch [130/200], 训练损失: 0.0002, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:06:01,586 - INFO - Epoch [131/200], 训练损失: 0.0001, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:06:05,861 - INFO - Epoch [132/200], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:06:10,108 - INFO - Epoch [133/200], 训练损失: 0.0001, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:06:14,355 - INFO - Epoch [134/200], 训练损失: 0.0001, 验证损失: 0.0004, 验证 R2: 0.9997
2025-07-22 20:06:18,712 - INFO - Epoch [135/200], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9998
2025-07-22 20:06:23,172 - INFO - Epoch [136/200], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9999
2025-07-22 20:06:27,400 - INFO - Epoch [137/200], 训练损失: 0.0001, 验证损失: 0.0002, 验证 R2: 0.9998
2025-07-22 20:06:31,621 - INFO - Epoch [138/200], 训练损失: 0.0001, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:06:35,919 - INFO - Epoch [139/200], 训练损失: 0.0001, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:06:40,334 - INFO - Epoch [140/200], 训练损失: 0.0001, 验证损失: 0.0001, 验证 R2: 0.9999
2025-07-22 20:06:44,585 - INFO - Epoch [141/200], 训练损失: 0.0001, 验证损失: 0.0003, 验证 R2: 0.9997
2025-07-22 20:06:44,585 - INFO - 早停！验证损失在 25 个epoch内没有显著改善。
2025-07-22 20:06:44,589 - INFO - --- 模型训练完成 ---
2025-07-22 20:06:44,756 - INFO - 图表已保存到: logs\训练与验证损失曲线.png
2025-07-22 20:06:50,245 - INFO - 图表已保存到: logs\验证集R2分数曲线.png
2025-07-22 20:06:53,220 - INFO - 
--- Phase 4: Model Evaluation and Visualization ---
2025-07-22 20:06:53,718 - INFO - 评估结果 - 损失: 0.0001, RMSE: 0.0108, R2: 0.9999
2025-07-22 20:06:53,718 - INFO - 
--- Best model's final evaluation results on test set ---
2025-07-22 20:06:53,718 - INFO - Test set Loss (MSE): 0.0001
2025-07-22 20:06:53,718 - INFO - Test set RMSE: 0.0108
2025-07-22 20:06:53,952 - INFO - 图表已保存到: logs\FTTransformer_predictions_vs_actual.png
2025-07-22 20:07:03,176 - INFO - 图表已保存到: logs\FTTransformer_residuals_distribution.png
2025-07-22 20:07:50,459 - INFO - 
--- Phase 5: Model Saving and Application ---
2025-07-22 20:07:50,506 - INFO - 模型已保存到: ./models/housing_model_ftt_optuna_final.pth
2025-07-22 20:07:50,572 - INFO - 模型已从 './models/housing_model_ftt_optuna_final.pth' 加载。
2025-07-22 20:07:50,573 - INFO - 
New data to predict (raw):
2025-07-22 20:07:50,573 - INFO -    MedInc  HouseAge  AveRooms  AveBedrms  Population  AveOccup  Latitude  Longitude
0     3.5      25.0       5.5        1.1      1200.0       2.8      34.0     -118.0
1     4.0      15.0       6.0        1.0      1500.0       3.0      34.5     -118.5
2     2.8      40.0       4.8        1.2       800.0       2.5      33.8     -117.5
3     5.2      10.0       7.0        0.9      2000.0       3.2      34.2     -118.2
4     3.1      30.0       5.0        1.1      1000.0       2.7      33.9     -117.8
2025-07-22 20:07:50,611 - INFO - 数据从 './data/california_housing.csv' 加载成功！
2025-07-22 20:07:50,611 - INFO - 
--- 缺失值处理 ---
2025-07-22 20:07:50,611 - INFO - 数据集中没有发现缺失值。
2025-07-22 20:07:50,611 - INFO - 
--- 异常值处理 ---
2025-07-22 20:07:50,633 - INFO - 已使用 IQR 方法处理 5594 个异常值 (替换为边界值)。
2025-07-22 20:07:50,634 - INFO - 
--- 特征工程 ---
2025-07-22 20:07:50,636 - INFO - 已创建新特征 'Bedrms_Per_Room'。
2025-07-22 20:07:50,637 - INFO - 已创建新特征 'Population_Density'。
2025-07-22 20:07:50,637 - INFO - 已创建新特征 'Lat_x_Lon'。
2025-07-22 20:07:50,638 - INFO - 特征工程完成。
2025-07-22 20:07:50,650 - INFO - 
New data prediction results:
2025-07-22 20:07:50,650 - INFO -    MedInc  HouseAge  AveRooms  AveBedrms  Population  AveOccup  Latitude  Longitude  Predicted_House_Value
0     3.5      25.0       5.5        1.1      1200.0       2.8      34.0     -118.0               1.240901
1     4.0      15.0       6.0        1.0      1500.0       3.0      34.5     -118.5               1.413835
2     2.8      40.0       4.8        1.2       800.0       2.5      33.8     -117.5               1.276501
3     5.2      10.0       7.0        0.9      2000.0       3.2      34.2     -118.2               1.514521
4     3.1      30.0       5.0        1.1      1000.0       2.7      33.9     -117.8               1.249195
2025-07-22 20:07:50,668 - INFO - 
--- Machine Learning House Price Prediction Project (Deep Learning Version) Completed ---
