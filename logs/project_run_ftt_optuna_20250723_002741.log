2025-07-23 00:27:41,393 - INFO - --- 机器学习房屋价格预测项目 (深度学习版) - 集成FT-Transformer和Optuna启动 ---
2025-07-23 00:27:41,397 - INFO - 已设置随机种子为: 42
2025-07-23 00:27:41,397 - INFO - 
--- 阶段1: 数据获取、探索与预处理 ---
2025-07-23 00:27:41,423 - INFO - 数据从 './data/california_housing.csv' 加载成功！
2025-07-23 00:27:41,424 - INFO - 
--- 数据概览 ---
2025-07-23 00:27:41,424 - INFO - 数据前5行:
2025-07-23 00:27:41,424 - INFO -    MedInc  HouseAge  AveRooms  AveBedrms  ...  AveOccup  Latitude  Longitude  target
0  8.3252        41  6.984127   1.023810  ...  2.555556     37.88    -122.23   4.526
1  8.3014        21  6.238137   0.971880  ...  2.109842     37.86    -122.22   3.585
2  7.2574        52  8.288136   1.073446  ...  2.802260     37.85    -122.24   3.521
3  5.6431        52  5.817352   1.073059  ...  2.547945     37.85    -122.25   3.413
4  3.8462        52  6.281853   1.081081  ...  2.181467     37.85    -122.25   3.422

[5 rows x 9 columns]
2025-07-23 00:27:41,439 - INFO - 
数据基本信息:
2025-07-23 00:27:41,442 - INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   MedInc      20640 non-null  float64
 1   HouseAge    20640 non-null  int64  
 2   AveRooms    20640 non-null  float64
 3   AveBedrms   20640 non-null  float64
 4   Population  20640 non-null  int64  
 5   AveOccup    20640 non-null  float64
 6   Latitude    20640 non-null  float64
 7   Longitude   20640 non-null  float64
 8   target      20640 non-null  float64
dtypes: float64(7), int64(2)
memory usage: 1.4 MB

2025-07-23 00:27:41,442 - INFO - 
描述性统计:
2025-07-23 00:27:41,455 - INFO -              MedInc      HouseAge  ...     Longitude        target
count  20640.000000  20640.000000  ...  20640.000000  20640.000000
mean       3.870671     28.639486  ...   -119.569704      2.068558
std        1.899822     12.585558  ...      2.003532      1.153956
min        0.499900      1.000000  ...   -124.350000      0.149990
25%        2.563400     18.000000  ...   -121.800000      1.196000
50%        3.534800     29.000000  ...   -118.490000      1.797000
75%        4.743250     37.000000  ...   -118.010000      2.647250
max       15.000100     52.000000  ...   -114.310000      5.000010

[8 rows x 9 columns]
2025-07-23 00:27:41,466 - INFO - 
缺失值检查:
2025-07-23 00:27:41,466 - INFO - MedInc        0
HouseAge      0
AveRooms      0
AveBedrms     0
Population    0
AveOccup      0
Latitude      0
Longitude     0
target        0
dtype: int64
2025-07-23 00:27:41,467 - INFO - 
数据初步探索完成。
2025-07-23 00:27:41,467 - INFO - 
--- 数据初步可视化 ---
2025-07-23 00:27:41,896 - INFO - 图表已保存到: logs\房屋价格分布.png
2025-07-23 00:27:45,006 - INFO - 图表已保存到: logs\特征与房价散点图.png
2025-07-23 00:27:47,984 - INFO - 
数据初步可视化完成。
2025-07-23 00:27:47,985 - INFO - 
--- 缺失值处理 ---
2025-07-23 00:27:47,985 - INFO - 数据集中没有发现缺失值。
2025-07-23 00:27:47,985 - INFO - 
--- 异常值处理 ---
2025-07-23 00:27:48,002 - INFO - 已使用 IQR 方法处理 4523 个异常值 (替换为边界值)。
2025-07-23 00:27:48,002 - INFO - 
--- 特征工程 ---
2025-07-23 00:27:48,004 - INFO - 已创建新特征 'Bedrms_Per_Room'。
2025-07-23 00:27:48,005 - INFO - 已创建新特征 'Population_Density'。
2025-07-23 00:27:48,005 - INFO - 已创建新特征 'Lat_x_Lon'。
2025-07-23 00:27:48,005 - INFO - 特征工程完成。
2025-07-23 00:27:48,005 - INFO - 
--- 数据划分与特征缩放 ---
2025-07-23 00:27:48,011 - INFO - 选择 StandardScaler 进行特征缩放。
2025-07-23 00:27:48,019 - INFO - 目标变量已使用 StandardScaler 进行缩放。
2025-07-23 00:27:48,019 - INFO - 训练集特征形状: (18576, 11)
2025-07-23 00:27:48,019 - INFO - 测试集特征形状: (2064, 11)
2025-07-23 00:27:48,021 - INFO - 训练集目标形状: (18576,)
2025-07-23 00:27:48,021 - INFO - 测试集目标形状: (2064,)
2025-07-23 00:27:48,021 - INFO - 数据划分与特征缩放完成。
2025-07-23 00:27:48,025 - INFO - 特征标准化器已保存到: ./models/scaler_ftt_optuna.pkl
2025-07-23 00:27:48,025 - INFO - 目标标准化器已保存到: ./models/target_scaler_ftt_optuna.pkl
2025-07-23 00:27:48,030 - INFO - 
训练集特征形状 (Tensor): torch.Size([13932, 11])
2025-07-23 00:27:48,030 - INFO - 验证集特征形状 (Tensor): torch.Size([4644, 11])
2025-07-23 00:27:48,030 - INFO - 测试集特征形状 (Tensor): torch.Size([2064, 11])
2025-07-23 00:27:48,030 - INFO - 训练集目标形状 (Tensor): torch.Size([13932, 1])
2025-07-23 00:27:48,030 - INFO - 验证集目标形状 (Tensor): torch.Size([4644, 1])
2025-07-23 00:27:48,030 - INFO - 测试集目标形状 (Tensor): torch.Size([2064, 1])
2025-07-23 00:27:48,030 - INFO - 训练数据加载器包含 218 个批次。
2025-07-23 00:27:48,030 - INFO - 验证数据加载器包含 73 个批次。
2025-07-23 00:27:48,030 - INFO - 测试数据加载器包含 33 个批次。
2025-07-23 00:27:48,030 - INFO - 
--- 阶段2: 超参数优化 (Optuna) ---
2025-07-23 00:27:48,030 - INFO - 
--- 开始 Optuna 超参数优化 (共 100 次试验) ---
2025-07-23 00:27:50,357 - INFO - Trial 0: 选择了 FT-Transformer 模型
2025-07-23 00:27:52,508 - INFO - 
--- 模型训练开始 ---
2025-07-23 00:27:58,061 - INFO - Epoch [1/50], 训练损失: 0.5728, 验证损失: 0.2893, 验证 R2 (标准化): 0.6988
2025-07-23 00:28:01,636 - INFO - Epoch [2/50], 训练损失: 0.2737, 验证损失: 0.3176, 验证 R2 (标准化): 0.6694
2025-07-23 00:28:05,244 - INFO - Epoch [3/50], 训练损失: 0.2531, 验证损失: 0.2593, 验证 R2 (标准化): 0.7300
2025-07-23 00:28:08,877 - INFO - Epoch [4/50], 训练损失: 0.2373, 验证损失: 0.2497, 验证 R2 (标准化): 0.7400
2025-07-23 00:28:12,407 - INFO - Epoch [5/50], 训练损失: 0.2281, 验证损失: 0.2308, 验证 R2 (标准化): 0.7597
2025-07-23 00:28:15,917 - INFO - Epoch [6/50], 训练损失: 0.2228, 验证损失: 0.2902, 验证 R2 (标准化): 0.6978
2025-07-23 00:28:19,490 - INFO - Epoch [7/50], 训练损失: 0.2165, 验证损失: 0.2238, 验证 R2 (标准化): 0.7670
2025-07-23 00:28:23,115 - INFO - Epoch [8/50], 训练损失: 0.2114, 验证损失: 0.2138, 验证 R2 (标准化): 0.7774
