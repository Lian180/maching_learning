2025-07-23 00:21:12,834 - INFO - --- 机器学习房屋价格预测项目 (深度学习版) - 集成FT-Transformer和Optuna启动 ---
2025-07-23 00:21:12,837 - INFO - 已设置随机种子为: 42
2025-07-23 00:21:12,837 - INFO - 
--- 阶段1: 数据获取、探索与预处理 ---
2025-07-23 00:21:12,861 - INFO - 数据从 './data/california_housing.csv' 加载成功！
2025-07-23 00:21:12,861 - INFO - 
--- 数据概览 ---
2025-07-23 00:21:12,861 - INFO - 数据前5行:
2025-07-23 00:21:12,862 - INFO -    MedInc  HouseAge  AveRooms  ...  Longitude  MedHouseVal  target
0  8.3252      41.0  6.984127  ...    -122.23        4.526   4.526
1  8.3014      21.0  6.238137  ...    -122.22        3.585   3.585
2  7.2574      52.0  8.288136  ...    -122.24        3.521   3.521
3  5.6431      52.0  5.817352  ...    -122.25        3.413   3.413
4  3.8462      52.0  6.281853  ...    -122.25        3.422   3.422

[5 rows x 10 columns]
2025-07-23 00:21:12,876 - INFO - 
数据基本信息:
2025-07-23 00:21:12,880 - INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 10 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   MedInc       20640 non-null  float64
 1   HouseAge     20640 non-null  float64
 2   AveRooms     20640 non-null  float64
 3   AveBedrms    20640 non-null  float64
 4   Population   20640 non-null  float64
 5   AveOccup     20640 non-null  float64
 6   Latitude     20640 non-null  float64
 7   Longitude    20640 non-null  float64
 8   MedHouseVal  20640 non-null  float64
 9   target       20640 non-null  float64
dtypes: float64(10)
memory usage: 1.6 MB

2025-07-23 00:21:12,880 - INFO - 
描述性统计:
2025-07-23 00:21:12,893 - INFO -              MedInc      HouseAge  ...   MedHouseVal        target
count  20640.000000  20640.000000  ...  20640.000000  20640.000000
mean       3.870671     28.639486  ...      2.068558      2.068558
std        1.899822     12.585558  ...      1.153956      1.153956
min        0.499900      1.000000  ...      0.149990      0.149990
25%        2.563400     18.000000  ...      1.196000      1.196000
50%        3.534800     29.000000  ...      1.797000      1.797000
75%        4.743250     37.000000  ...      2.647250      2.647250
max       15.000100     52.000000  ...      5.000010      5.000010

[8 rows x 10 columns]
2025-07-23 00:21:12,906 - INFO - 
缺失值检查:
2025-07-23 00:21:12,906 - INFO - MedInc         0
HouseAge       0
AveRooms       0
AveBedrms      0
Population     0
AveOccup       0
Latitude       0
Longitude      0
MedHouseVal    0
target         0
dtype: int64
2025-07-23 00:21:12,907 - INFO - 
数据初步探索完成。
2025-07-23 00:21:12,908 - INFO - 
--- 数据初步可视化 ---
2025-07-23 00:21:13,295 - INFO - 图表已保存到: logs\房屋价格分布.png
2025-07-23 00:21:17,053 - INFO - 图表已保存到: logs\特征与房价散点图.png
2025-07-23 00:21:21,163 - INFO - 
数据初步可视化完成。
2025-07-23 00:21:21,165 - INFO - 
--- 缺失值处理 ---
2025-07-23 00:21:21,166 - INFO - 数据集中没有发现缺失值。
2025-07-23 00:21:21,166 - INFO - 
--- 异常值处理 ---
2025-07-23 00:21:21,181 - INFO - 已使用 IQR 方法处理 5594 个异常值 (替换为边界值)。
2025-07-23 00:21:21,182 - INFO - 
--- 特征工程 ---
2025-07-23 00:21:21,185 - INFO - 已创建新特征 'Bedrms_Per_Room'。
2025-07-23 00:21:21,186 - INFO - 已创建新特征 'Population_Density'。
2025-07-23 00:21:21,187 - INFO - 已创建新特征 'Lat_x_Lon'。
2025-07-23 00:21:21,187 - INFO - 特征工程完成。
2025-07-23 00:21:21,187 - INFO - 
--- 数据划分与特征缩放 ---
2025-07-23 00:21:21,191 - INFO - 选择 StandardScaler 进行特征缩放。
2025-07-23 00:21:21,198 - INFO - 目标变量已使用 StandardScaler 进行缩放。
2025-07-23 00:21:21,198 - INFO - 训练集特征形状: (16512, 12)
2025-07-23 00:21:21,198 - INFO - 测试集特征形状: (4128, 12)
2025-07-23 00:21:21,198 - INFO - 训练集目标形状: (16512,)
2025-07-23 00:21:21,198 - INFO - 测试集目标形状: (4128,)
2025-07-23 00:21:21,198 - INFO - 数据划分与特征缩放完成。
2025-07-23 00:21:21,204 - INFO - 特征标准化器已保存到: ./models/scaler_ftt_optuna.pkl
2025-07-23 00:21:21,204 - INFO - 目标标准化器已保存到: ./models/target_scaler_ftt_optuna.pkl
2025-07-23 00:21:21,208 - INFO - 
训练集特征形状 (Tensor): torch.Size([12384, 12])
2025-07-23 00:21:21,208 - INFO - 验证集特征形状 (Tensor): torch.Size([4128, 12])
2025-07-23 00:21:21,208 - INFO - 测试集特征形状 (Tensor): torch.Size([4128, 12])
2025-07-23 00:21:21,208 - INFO - 训练集目标形状 (Tensor): torch.Size([12384, 1])
2025-07-23 00:21:21,208 - INFO - 验证集目标形状 (Tensor): torch.Size([4128, 1])
2025-07-23 00:21:21,208 - INFO - 测试集目标形状 (Tensor): torch.Size([4128, 1])
2025-07-23 00:21:21,208 - INFO - 训练数据加载器包含 194 个批次。
2025-07-23 00:21:21,209 - INFO - 验证数据加载器包含 65 个批次。
2025-07-23 00:21:21,209 - INFO - 测试数据加载器包含 65 个批次。
2025-07-23 00:21:21,209 - INFO - 
--- 阶段2: 超参数优化 (Optuna) ---
